<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Part 107 FAA Exam Study Guide</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d0a0a 50%, #1a1a1a 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.6), 0 0 20px rgba(211, 47, 47, 0.3);
            overflow: hidden;
            border: 2px solid #1a1a1a;
        }

        .header {
            background: linear-gradient(135deg, #b71c1c 0%, #1a1a1a 100%);
            color: white;
            padding: 30px;
            text-align: center;
            border-bottom: 3px solid #ff1744;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .progress-bar {
            background: #f0f0f0;
            height: 30px;
            border-radius: 15px;
            margin: 20px 30px;
            overflow: hidden;
            position: relative;
        }

        .progress-fill {
            background: linear-gradient(90deg, #d32f2f 0%, #b71c1c 100%);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }

        .stats {
            display: flex;
            justify-content: space-around;
            padding: 20px 30px;
            background: linear-gradient(135deg, #f8f9fa 0%, #fff 100%);
            border-bottom: 3px solid #d32f2f;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: bold;
            color: #d32f2f;
        }

        .stat-label {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }

        .question-container {
            padding: 40px;
        }

        .question-header {
            margin-bottom: 20px;
        }

        .category-badge {
            display: inline-block;
            background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9em;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(211, 47, 47, 0.3);
        }

        .question-text {
            font-size: 1.3em;
            line-height: 1.6;
            color: #1a1a1a;
            margin-bottom: 30px;
            font-weight: 500;
        }

        .options {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .option {
            background: #f8f9fa;
            border: 3px solid #e0e0e0;
            border-radius: 12px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .option:hover {
            background: #ffe0e0;
            border-color: #d32f2f;
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(211, 47, 47, 0.2);
        }

        .option-letter {
            background: linear-gradient(135deg, #1a1a1a 0%, #2d0a0a 100%);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
            flex-shrink: 0;
            border: 2px solid #d32f2f;
        }

        .option-text {
            flex: 1;
            font-size: 1.1em;
        }

        .option.correct {
            background: #d4edda;
            border-color: #28a745;
        }

        .option.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
        }

        .option.correct .option-letter {
            background: #28a745;
        }

        .option.incorrect .option-letter {
            background: #dc3545;
        }

        .feedback {
            margin-top: 25px;
            padding: 20px;
            border-radius: 12px;
            display: none;
        }

        .feedback.show {
            display: block;
        }

        .feedback.correct {
            background: #d4edda;
            border: 2px solid #28a745;
            color: #155724;
        }

        .feedback.incorrect {
            background: #fff3cd;
            border: 2px solid #ffc107;
            color: #856404;
        }

        .feedback-title {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .feedback-message {
            font-size: 1.1em;
            line-height: 1.6;
        }

        .explanation {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(0, 0, 0, 0.1);
            font-style: italic;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            padding: 30px 40px;
            background: #f8f9fa;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(211, 47, 47, 0.5);
            background: linear-gradient(135deg, #e53935 0%, #c62828 100%);
        }

        .btn-secondary {
            background: #1a1a1a;
            color: white;
            border: 2px solid #d32f2f;
        }

        .btn-secondary:hover {
            background: #2d0a0a;
            border-color: #ff1744;
            box-shadow: 0 4px 12px rgba(211, 47, 47, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .results-container {
            display: none;
            padding: 40px;
            text-align: center;
        }

        .results-container.show {
            display: block;
        }

        .results-title {
            font-size: 2.5em;
            color: #d32f2f;
            margin-bottom: 20px;
        }

        .results-score {
            font-size: 4em;
            font-weight: bold;
            color: #d32f2f;
            margin: 30px 0;
            text-shadow: 2px 2px 4px rgba(211, 47, 47, 0.2);
        }

        .results-message {
            font-size: 1.3em;
            line-height: 1.8;
            color: #666;
            margin: 20px 0;
        }

        .results-breakdown {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .breakdown-item {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
        }

        .breakdown-value {
            font-size: 2em;
            font-weight: bold;
            color: #d32f2f;
        }

        .breakdown-label {
            color: #666;
            margin-top: 5px;
        }

        .start-screen {
            padding: 60px 40px;
            text-align: center;
        }

        .start-screen h2 {
            font-size: 2em;
            color: #333;
            margin-bottom: 20px;
        }

        .start-screen p {
            font-size: 1.2em;
            color: #666;
            line-height: 1.8;
            margin-bottom: 30px;
        }

        .topics-list {
            text-align: left;
            max-width: 600px;
            margin: 30px auto;
            background: #f8f9fa;
            padding: 30px;
            border-radius: 12px;
        }

        .topics-list h3 {
            color: #d32f2f;
            margin-bottom: 20px;
            font-size: 1.5em;
        }

        .topics-list ul {
            list-style: none;
        }

        .topics-list li {
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
            font-size: 1.1em;
        }

        .topics-list li:before {
            content: "‚úì ";
            color: #28a745;
            font-weight: bold;
            margin-right: 10px;
        }

        .topics-list li:last-child {
            border-bottom: none;
        }

        /* Visual Dashboard Styles */
        .visual-dashboard {
            padding: 30px;
            background: linear-gradient(135deg, #f8f9fa 0%, #fff 100%);
            border-bottom: 3px solid #d32f2f;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }

        .chart-container {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 2px solid #e0e0e0;
        }

        .chart-title {
            font-size: 1.3em;
            font-weight: bold;
            color: #d32f2f;
            margin-bottom: 15px;
            text-align: center;
        }

        .chart-canvas {
            max-height: 300px;
        }

        /* Airspace Visual Diagram */
        .airspace-diagram {
            background: white;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 2px solid #e0e0e0;
        }

        .airspace-diagram h3 {
            color: #d32f2f;
            margin-bottom: 20px;
            font-size: 1.4em;
            text-align: center;
        }

        .airspace-layers {
            display: flex;
            flex-direction: column;
            gap: 10px;
            max-width: 600px;
            margin: 0 auto;
        }

        .airspace-layer {
            display: flex;
            align-items: center;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .airspace-layer:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .airspace-class-a {
            background: linear-gradient(90deg, #e3f2fd, #fff);
            border-color: #2196F3;
        }

        .airspace-class-b {
            background: linear-gradient(90deg, #f3e5f5, #fff);
            border-color: #9C27B0;
        }

        .airspace-class-c {
            background: linear-gradient(90deg, #fff3e0, #fff);
            border-color: #FF9800;
        }

        .airspace-class-d {
            background: linear-gradient(90deg, #fce4ec, #fff);
            border-color: #E91E63;
        }

        .airspace-class-e {
            background: linear-gradient(90deg, #f1f8e9, #fff);
            border-color: #8BC34A;
        }

        .airspace-class-g {
            background: linear-gradient(90deg, #fff9c4, #fff);
            border-color: #FFC107;
        }

        .airspace-icon {
            font-size: 2em;
            margin-right: 15px;
            min-width: 50px;
            text-align: center;
        }

        .airspace-info {
            flex: 1;
        }

        .airspace-name {
            font-weight: bold;
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .airspace-desc {
            color: #666;
            font-size: 0.95em;
        }

        /* Performance breakdown table */
        .performance-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        .performance-table th,
        .performance-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .performance-table th {
            background: #f8f9fa;
            font-weight: bold;
            color: #d32f2f;
        }

        .performance-table tr:hover {
            background: #f8f9fa;
        }

        .category-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: bold;
            background: linear-gradient(135deg, #d32f2f, #b71c1c);
            color: white;
        }

        .score-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-weight: bold;
        }

        .score-excellent {
            background: #4caf50;
            color: white;
        }

        .score-good {
            background: #8bc34a;
            color: white;
        }

        .score-fair {
            background: #ffc107;
            color: #333;
        }

        .score-poor {
            background: #f44336;
            color: white;
        }

        /* Visual Reference Section */
        .visual-reference {
            padding: 30px;
            background: white;
        }

        .reference-title {
            font-size: 1.8em;
            color: #d32f2f;
            margin-bottom: 20px;
            text-align: center;
        }

        .reference-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .reference-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .reference-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        }

        .reference-card h4 {
            color: #d32f2f;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .reference-card ul {
            list-style: none;
            padding: 0;
        }

        .reference-card li {
            padding: 5px 0;
            color: #666;
        }

        .reference-card li::before {
            content: "‚úì ";
            color: #4caf50;
            font-weight: bold;
            margin-right: 5px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .question-text {
                font-size: 1.1em;
            }

            .option {
                padding: 15px;
            }

            .stats {
                flex-direction: column;
                gap: 15px;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .reference-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>‚úàÔ∏è Part 107 FAA Exam Study Guide</h1>
            <p>Master Your Remote Pilot Knowledge</p>
        </div>

        <div id="startScreen" class="start-screen">
            <h2>Welcome to Your Interactive Study Guide!</h2>
            <p>This comprehensive guide covers everything you need to know to pass the Part 107 FAA Remote Pilot exam. Answer multiple choice questions, get instant feedback, and track your progress.</p>
            
            <div class="topics-list">
                <h3>üìö Topics Covered:</h3>
                <ul>
                    <li>Airspace Classification & Requirements</li>
                    <li>Weather Theory & Meteorology</li>
                    <li>Regulations & Operating Requirements</li>
                    <li>Loading & Performance</li>
                    <li>Emergency Procedures</li>
                    <li>Crew Resource Management</li>
                    <li>Radio Communication</li>
                    <li>Airport Operations</li>
                    <li>Aeronautical Decision Making</li>
                    <li>Maintenance & Preflight</li>
                </ul>
            </div>

            <p><strong>You have until March to prepare - let's get started!</strong></p>
            
            <!-- Visual Dashboard Section -->
            <div class="visual-dashboard">
                <h3 class="reference-title">üìä Study Guide Overview</h3>
                <div class="dashboard-grid">
                    <div class="chart-container">
                        <div class="chart-title">Questions by Category</div>
                        <canvas id="categoryChart" class="chart-canvas"></canvas>
                    </div>
                </div>
            </div>

            <!-- Airspace Classification Visual -->
            <div class="visual-reference">
                <div class="airspace-diagram">
                    <h3>üõ©Ô∏è Airspace Classification Quick Reference</h3>
                    <div class="airspace-layers">
                        <div class="airspace-layer airspace-class-a">
                            <div class="airspace-icon">üîµ</div>
                            <div class="airspace-info">
                                <div class="airspace-name">Class A (18,000' - 60,000' MSL)</div>
                                <div class="airspace-desc">IFR only, ATC clearance required - Not applicable to Part 107</div>
                            </div>
                        </div>
                        <div class="airspace-layer airspace-class-b">
                            <div class="airspace-icon">üü£</div>
                            <div class="airspace-info">
                                <div class="airspace-name">Class B (Major Airports)</div>
                                <div class="airspace-desc">ATC authorization required via LAANC or DroneZone</div>
                            </div>
                        </div>
                        <div class="airspace-layer airspace-class-c">
                            <div class="airspace-icon">üü†</div>
                            <div class="airspace-info">
                                <div class="airspace-name">Class C (Busy Airports)</div>
                                <div class="airspace-desc">ATC authorization required via LAANC or DroneZone</div>
                            </div>
                        </div>
                        <div class="airspace-layer airspace-class-d">
                            <div class="airspace-icon">üî¥</div>
                            <div class="airspace-info">
                                <div class="airspace-name">Class D (Towered Airports)</div>
                                <div class="airspace-desc">ATC authorization required via LAANC or DroneZone</div>
                            </div>
                        </div>
                        <div class="airspace-layer airspace-class-e">
                            <div class="airspace-icon">üü¢</div>
                            <div class="airspace-info">
                                <div class="airspace-name">Class E (Controlled Airspace)</div>
                                <div class="airspace-desc">Surface area E requires authorization; E above 400' AGL typically OK</div>
                            </div>
                        </div>
                        <div class="airspace-layer airspace-class-g">
                            <div class="airspace-icon">üü°</div>
                            <div class="airspace-info">
                                <div class="airspace-name">Class G (Uncontrolled)</div>
                                <div class="airspace-desc">No ATC authorization needed - Most common for Part 107 ops</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Annotated Sectional Chart -->
                <div class="airspace-diagram">
                    <h3>üó∫Ô∏è Sectional Chart Visual Guide - What You'll See on the Test</h3>
                    <p style="text-align: center; color: #666; margin-bottom: 20px;">This annotated chart shows how airspace and symbols appear on actual VFR sectional charts used in the FAA exam</p>
                    
                    <svg viewBox="0 0 800 600" xmlns="http://www.w3.org/2000/svg" style="width: 100%; max-width: 900px; margin: 0 auto; display: block; background: #f5f3e8; border: 2px solid #333; border-radius: 8px;">
                        <!-- Background terrain colors -->
                        <rect x="0" y="0" width="800" height="600" fill="#f5f3e8"/>
                        
                        <!-- Terrain contour lines (brown) -->
                        <path d="M 50 400 Q 100 390, 150 395 T 250 400" stroke="#8B4513" stroke-width="1" fill="none" opacity="0.5"/>
                        <path d="M 60 420 Q 110 410, 160 415 T 260 420" stroke="#8B4513" stroke-width="1" fill="none" opacity="0.5"/>
                        <path d="M 70 440 Q 120 430, 170 435 T 270 440" stroke="#8B4513" stroke-width="1" fill="none" opacity="0.5"/>
                        
                        <!-- Class E 700' AGL (magenta shading with scalloped edges) -->
                        <ellipse cx="650" cy="450" rx="120" ry="100" fill="#E91E63" opacity="0.15"/>
                        <path d="M 530 450 Q 540 430, 550 450 T 570 450 T 590 450 T 610 450 T 630 450 T 650 450 T 670 450 T 690 450 T 710 450 T 730 450 T 750 450 Q 760 470, 770 450" 
                              stroke="#E91E63" stroke-width="1.5" fill="none" opacity="0.6" stroke-dasharray="5,3"/>
                        <text x="650" y="520" text-anchor="middle" fill="#C2185B" font-size="11" font-weight="bold">Class E</text>
                        <text x="650" y="535" text-anchor="middle" fill="#666" font-size="10">700' AGL (magenta scalloped)</text>
                        
                        <!-- Restricted Area R-2508 -->
                        <rect x="30" y="80" width="140" height="100" fill="#FF0000" opacity="0.1" stroke="#FF0000" stroke-width="2" stroke-dasharray="8,4"/>
                        <text x="100" y="125" text-anchor="middle" fill="#CC0000" font-size="14" font-weight="bold">R-2508</text>
                        <text x="100" y="142" text-anchor="middle" fill="#666" font-size="9">SFC-FL180</text>
                        <text x="100" y="200" text-anchor="middle" fill="#CC0000" font-size="10" font-weight="bold">‚Üë Restricted Area</text>
                        <text x="100" y="213" text-anchor="middle" fill="#666" font-size="9">(Red hatched border)</text>
                        
                        <!-- MOA (Military Operations Area) -->
                        <path d="M 580 80 L 750 80 L 750 180 L 580 180 Z" fill="#E91E63" opacity="0.08" stroke="#E91E63" stroke-width="2" stroke-dasharray="6,3"/>
                        <line x1="585" y1="85" x2="745" y2="85" stroke="#E91E63" stroke-width="1" opacity="0.4"/>
                        <line x1="585" y1="95" x2="745" y2="95" stroke="#E91E63" stroke-width="1" opacity="0.4"/>
                        <line x1="585" y1="105" x2="745" y2="105" stroke="#E91E63" stroke-width="1" opacity="0.4"/>
                        <text x="665" y="125" text-anchor="middle" fill="#C2185B" font-size="13" font-weight="bold">NIGHTHAWK MOA</text>
                        <text x="665" y="142" text-anchor="middle" fill="#666" font-size="9">SFC-10,000</text>
                        <text x="665" y="205" text-anchor="middle" fill="#C2185B" font-size="10" font-weight="bold">‚Üë MOA</text>
                        <text x="665" y="218" text-anchor="middle" fill="#666" font-size="9">(Magenta hatched border)</text>
                        
                        <!-- Class B Airspace (solid blue) -->
                        <ellipse cx="400" cy="300" rx="90" ry="75" fill="#2196F3" opacity="0.15" stroke="#0D47A1" stroke-width="3"/>
                        <ellipse cx="400" cy="300" rx="60" ry="50" fill="#2196F3" opacity="0.2" stroke="#0D47A1" stroke-width="3"/>
                        <text x="400" y="255" text-anchor="middle" fill="#0D47A1" font-size="11" font-weight="bold">100</text>
                        <text x="400" y="268" text-anchor="middle" fill="#0D47A1" font-size="10">SFC</text>
                        <text x="450" y="290" text-anchor="middle" fill="#0D47A1" font-size="11" font-weight="bold">80</text>
                        <text x="450" y="303" text-anchor="middle" fill="#0D47A1" font-size="10">30</text>
                        <text x="400" y="390" text-anchor="middle" fill="#0D47A1" font-size="11" font-weight="bold">‚Üë Class B Airspace</text>
                        <text x="400" y="405" text-anchor="middle" fill="#666" font-size="9">(Solid blue lines)</text>
                        
                        <!-- Major Airport (Blue) - Class B -->
                        <circle cx="400" cy="300" r="8" fill="#0D47A1" stroke="#0D47A1" stroke-width="2"/>
                        <line x1="400" y1="292" x2="400" y2="308" stroke="white" stroke-width="1.5"/>
                        <line x1="392" y1="300" x2="408" y2="300" stroke="white" stroke-width="1.5"/>
                        <text x="400" y="323" text-anchor="middle" fill="#0D47A1" font-size="9" font-weight="bold">79</text>
                        <line x1="400" y1="324" x2="400" y2="325" stroke="#0D47A1" stroke-width="0.5"/>
                        <text x="400" y="332" text-anchor="middle" fill="#0D47A1" font-size="8">26</text>
                        
                        <!-- Class C Airspace (solid magenta) -->
                        <circle cx="200" cy="300" r="55" fill="#E91E63" opacity="0.12" stroke="#C2185B" stroke-width="2.5"/>
                        <circle cx="200" cy="300" r="35" fill="#E91E63" opacity="0.15" stroke="#C2185B" stroke-width="2.5"/>
                        <text x="200" y="265" text-anchor="middle" fill="#C2185B" font-size="10" font-weight="bold">40</text>
                        <text x="200" y="276" text-anchor="middle" fill="#C2185B" font-size="9">SFC</text>
                        <text x="238" y="295" text-anchor="middle" fill="#C2185B" font-size="10" font-weight="bold">40</text>
                        <text x="238" y="306" text-anchor="middle" fill="#C2185B" font-size="9">12</text>
                        <text x="200" y="375" text-anchor="middle" fill="#C2185B" font-size="11" font-weight="bold">‚Üë Class C Airspace</text>
                        <text x="200" y="390" text-anchor="middle" fill="#666" font-size="9">(Solid magenta lines)</text>
                        
                        <!-- Busy Airport (Blue) - Class C -->
                        <circle cx="200" cy="300" r="7" fill="#0D47A1" stroke="#0D47A1" stroke-width="2"/>
                        <line x1="200" y1="293" x2="200" y2="307" stroke="white" stroke-width="1.5"/>
                        <line x1="193" y1="300" x2="207" y2="300" stroke="white" stroke-width="1.5"/>
                        <text x="200" y="320" text-anchor="middle" fill="#0D47A1" font-size="8" font-weight="bold">52</text>
                        <line x1="200" y1="321" x2="200" y2="322" stroke="#0D47A1" stroke-width="0.5"/>
                        <text x="200" y="329" text-anchor="middle" fill="#0D47A1" font-size="7">18</text>
                        
                        <!-- Class D Airspace (dashed magenta) -->
                        <circle cx="600" cy="300" r="40" fill="#E91E63" opacity="0.08" stroke="#E91E63" stroke-width="2" stroke-dasharray="8,4"/>
                        <text x="600" y="280" text-anchor="middle" fill="#C2185B" font-size="10" font-weight="bold">25</text>
                        <text x="600" y="291" text-anchor="middle" fill="#C2185B" font-size="9">SFC</text>
                        <text x="600" y="360" text-anchor="middle" fill="#C2185B" font-size="11" font-weight="bold">‚Üë Class D Airspace</text>
                        <text x="600" y="375" text-anchor="middle" fill="#666" font-size="9">(Dashed magenta lines)</text>
                        
                        <!-- Towered Airport (Blue) - Class D -->
                        <circle cx="600" cy="300" r="6" fill="#0D47A1" stroke="#0D47A1" stroke-width="2"/>
                        <line x1="600" y1="294" x2="600" y2="306" stroke="white" stroke-width="1.5"/>
                        <line x1="594" y1="300" x2="606" y2="300" stroke="white" stroke-width="1.5"/>
                        <text x="600" y="318" text-anchor="middle" fill="#0D47A1" font-size="8" font-weight="bold">35</text>
                        <line x1="600" y1="319" x2="600" y2="320" stroke="#0D47A1" stroke-width="0.5"/>
                        <text x="600" y="327" text-anchor="middle" fill="#0D47A1" font-size="7">12</text>
                        
                        <!-- Non-towered Airport (Magenta) -->
                        <circle cx="300" cy="480" r="5" fill="#E91E63" stroke="#E91E63" stroke-width="1.5"/>
                        <line x1="300" y1="475" x2="300" y2="485" stroke="white" stroke-width="1"/>
                        <line x1="295" y1="480" x2="305" y2="480" stroke="white" stroke-width="1"/>
                        <text x="300" y="500" text-anchor="middle" fill="#E91E63" font-size="8" font-weight="bold">38</text>
                        <line x1="300" y1="501" x2="300" y2="502" stroke="#E91E63" stroke-width="0.5"/>
                        <text x="300" y="509" text-anchor="middle" fill="#E91E63" font-size="7">08</text>
                        <text x="300" y="525" text-anchor="middle" fill="#C2185B" font-size="10" font-weight="bold">‚Üë Non-Towered Airport</text>
                        <text x="300" y="538" text-anchor="middle" fill="#666" font-size="9">(Magenta symbol)</text>
                        
                        <!-- Mode C Veil (blue segmented line) - around Class B -->
                        <circle cx="400" cy="300" r="130" fill="none" stroke="#1976D2" stroke-width="2" stroke-dasharray="10,6" opacity="0.7"/>
                        <text x="530" cy="305" text-anchor="middle" fill="#1565C0" font-size="9" font-weight="bold">Mode C Veil</text>
                        <text x="530" cy="315" text-anchor="middle" fill="#666" font-size="8">(30 NM radius)</text>
                        
                        <!-- Legend Box -->
                        <rect x="15" y="240" width="160" height="135" fill="white" stroke="#333" stroke-width="2" rx="5"/>
                        <text x="95" y="258" text-anchor="middle" font-weight="bold" font-size="12" fill="#333">Chart Legend</text>
                        <line x1="25" y1="262" x2="165" y2="262" stroke="#999" stroke-width="1"/>
                        
                        <!-- Legend items -->
                        <line x1="25" y1="275" x2="50" y2="275" stroke="#0D47A1" stroke-width="3"/>
                        <text x="55" y="279" font-size="9" fill="#333">Solid Blue = Class B</text>
                        
                        <line x1="25" y1="290" x2="50" y2="290" stroke="#C2185B" stroke-width="2.5"/>
                        <text x="55" y="294" font-size="9" fill="#333">Solid Magenta = Class C</text>
                        
                        <line x1="25" y1="305" x2="50" y2="305" stroke="#E91E63" stroke-width="2" stroke-dasharray="6,3"/>
                        <text x="55" y="309" font-size="9" fill="#333">Dashed Magenta = Class D</text>
                        
                        <circle cx="37.5" cy="320" r="3" fill="#0D47A1"/>
                        <text x="55" y="324" font-size="9" fill="#333">Blue = Towered Airport</text>
                        
                        <circle cx="37.5" cy="335" r="3" fill="#E91E63"/>
                        <text x="55" y="339" font-size="9" fill="#333">Magenta = Non-Towered</text>
                        
                        <text x="30" y="355" font-size="9" fill="#333" font-weight="bold">55</text>
                        <line x1="30" y1="356" x2="42" y2="356" stroke="#333" stroke-width="0.5"/>
                        <text x="30" y="364" font-size="8" fill="#333">30</text>
                        <text x="55" y="361" font-size="9" fill="#333">= Runway 5500'/Elev 3000'</text>
                        
                        <!-- Title -->
                        <text x="400" y="30" text-anchor="middle" font-weight="bold" font-size="16" fill="#333">VFR Sectional Chart - Airspace Examples</text>
                        <text x="400" y="50" text-anchor="middle" font-size="11" fill="#666">Study this chart to recognize airspace on the FAA exam</text>
                    </svg>
                </div>

                <!-- Quick Reference Cards -->
                <h3 class="reference-title">üìã Key Part 107 Facts</h3>
                <div class="reference-grid">
                    <div class="reference-card">
                        <h4>üéØ Altitude Limits</h4>
                        <ul>
                            <li>Max 400' AGL</li>
                            <li>+400' above structures</li>
                            <li>Measured from takeoff point</li>
                        </ul>
                    </div>
                    <div class="reference-card">
                        <h4>üëÅÔ∏è Visual Requirements</h4>
                        <ul>
                            <li>3 SM visibility minimum</li>
                            <li>VLOS required</li>
                            <li>Visual observer allowed</li>
                        </ul>
                    </div>
                    <div class="reference-card">
                        <h4>‚ö° Speed & Weather</h4>
                        <ul>
                            <li>Max 87 knots (100 mph)</li>
                            <li>No clouds in VLOS</li>
                            <li>Check winds before flight</li>
                        </ul>
                    </div>
                    <div class="reference-card">
                        <h4>üìú Certification</h4>
                        <ul>
                            <li>Age 16+ required</li>
                            <li>Renew every 2 years</li>
                            <li>Pass score: 70%</li>
                        </ul>
                    </div>
                    <div class="reference-card">
                        <h4>‚öñÔ∏è Registration</h4>
                        <ul>
                            <li>0.55+ lbs requires registration</li>
                            <li>Mark externally</li>
                            <li>Valid for 3 years</li>
                        </ul>
                    </div>
                    <div class="reference-card">
                        <h4>üåô Night Operations</h4>
                        <ul>
                            <li>Allowed with training</li>
                            <li>Anti-collision lights</li>
                            <li>Visible for 3 SM</li>
                        </ul>
                    </div>
                </div>
            </div>

            <button class="btn btn-primary" onclick="startQuiz()">Start Studying üöÄ</button>
        </div>

        <div id="quizScreen" style="display: none;">
            <div class="progress-bar">
                <div class="progress-fill" id="progressBar">0%</div>
            </div>

            <div class="stats">
                <div class="stat">
                    <div class="stat-value" id="currentQuestion">0</div>
                    <div class="stat-label">Question</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="correctCount">0</div>
                    <div class="stat-label">Correct</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="scorePercent">0%</div>
                    <div class="stat-label">Score</div>
                </div>
            </div>

            <div class="question-container">
                <div class="question-header">
                    <div class="category-badge" id="category"></div>
                    <div class="question-text" id="questionText"></div>
                </div>

                <div class="options" id="optionsContainer"></div>

                <div class="feedback" id="feedback"></div>
            </div>

            <div class="navigation">
                <button class="btn btn-secondary" id="prevBtn" onclick="previousQuestion()">‚Üê Previous</button>
                <button class="btn btn-primary" id="nextBtn" onclick="nextQuestion()" disabled>Next ‚Üí</button>
            </div>
        </div>

        <div id="resultsScreen" class="results-container">
            <div class="results-title">üéâ Quiz Complete!</div>
            <div class="results-score" id="finalScore"></div>
            <div class="results-message" id="resultsMessage"></div>
            
            <div class="results-breakdown">
                <div class="breakdown-item">
                    <div class="breakdown-value" id="totalAnswered">0</div>
                    <div class="breakdown-label">Questions Answered</div>
                </div>
                <div class="breakdown-item">
                    <div class="breakdown-value" id="totalCorrect">0</div>
                    <div class="breakdown-label">Correct Answers</div>
                </div>
                <div class="breakdown-item">
                    <div class="breakdown-value" id="totalIncorrect">0</div>
                    <div class="breakdown-label">Incorrect Answers</div>
                </div>
            </div>

            <!-- Performance Charts -->
            <div class="visual-dashboard">
                <h3 class="reference-title">üìä Your Performance Analysis</h3>
                <div class="dashboard-grid">
                    <div class="chart-container">
                        <div class="chart-title">Performance by Category</div>
                        <canvas id="performanceChart" class="chart-canvas"></canvas>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">Score Distribution</div>
                        <canvas id="scoreDistributionChart" class="chart-canvas"></canvas>
                    </div>
                </div>
                
                <!-- Category Performance Table -->
                <div class="chart-container" style="margin-top: 20px;">
                    <div class="chart-title">Detailed Category Breakdown</div>
                    <table class="performance-table" id="categoryPerformanceTable">
                        <thead>
                            <tr>
                                <th>Category</th>
                                <th>Correct</th>
                                <th>Total</th>
                                <th>Score</th>
                            </tr>
                        </thead>
                        <tbody id="categoryTableBody">
                        </tbody>
                    </table>
                </div>
            </div>

            <button class="btn btn-primary" onclick="restartQuiz()" style="margin-top: 30px;">Try Again üîÑ</button>
        </div>
    </div>

    <script>
        // Comprehensive Part 107 Question Bank
        const questions = [
            // Airspace Classification
            {
                category: "Airspace",
                question: "What is the maximum altitude you can fly a drone under Part 107 without special authorization?",
                options: [
                    "200 feet AGL",
                    "400 feet AGL",
                    "500 feet AGL",
                    "1000 feet AGL"
                ],
                correct: 1,
                explanation: "Under Part 107, the maximum altitude for drone operations is 400 feet above ground level (AGL) unless you're flying within 400 feet of a structure, in which case you can fly up to 400 feet above the structure's immediate uppermost limit."
            },
            {
                category: "Airspace",
                question: "Which class of airspace requires ATC authorization for drone operations?",
                options: [
                    "Class G airspace",
                    "Class E airspace below 400 feet",
                    "Class B, C, D, and E surface areas",
                    "All airspace requires authorization"
                ],
                correct: 2,
                explanation: "Class B, C, D, and surface area E airspace require ATC authorization through LAANC or DroneZone. Class G airspace (uncontrolled) does not require authorization, though you still must follow Part 107 regulations."
            },
            {
                category: "Airspace",
                question: "What does Class G airspace represent?",
                options: [
                    "Controlled airspace from surface to 18,000 feet",
                    "Uncontrolled airspace",
                    "Restricted airspace for military operations",
                    "Airspace around major airports"
                ],
                correct: 1,
                explanation: "Class G airspace is uncontrolled airspace where Air Traffic Control (ATC) does not provide services. It's where most recreational and commercial drone operations occur, typically below 1,200 feet AGL."
            },
            {
                category: "Airspace",
                question: "What is the purpose of a NOTAM?",
                options: [
                    "To certify remote pilots",
                    "To provide notice of abnormal conditions or hazards",
                    "To grant airspace authorization",
                    "To register drones"
                ],
                correct: 1,
                explanation: "NOTAM stands for Notice to Airmen. It provides time-critical information about abnormal conditions, hazards, or changes to facilities, services, procedures, or regulations. Remote pilots should check NOTAMs before every flight."
            },
            {
                category: "Airspace",
                question: "What does LAANC stand for?",
                options: [
                    "Low Altitude Authorization and Notification Capability",
                    "Local Airspace Acknowledgment and Navigation Control",
                    "Limited Aircraft Authorization for Networked Communications",
                    "Licensed Aviation Access to National Corridors"
                ],
                correct: 0,
                explanation: "LAANC (Low Altitude Authorization and Notification Capability) is an automated system that provides near real-time processing of airspace authorization requests for Part 107 drone operations in controlled airspace."
            },

            // Weather & Meteorology
            {
                category: "Weather",
                question: "What weather phenomenon poses the greatest threat to drone operations?",
                options: [
                    "Light rain",
                    "High winds",
                    "Partly cloudy skies",
                    "Temperature below 50¬∞F"
                ],
                correct: 1,
                explanation: "High winds are extremely dangerous for drone operations. Most consumer and commercial drones cannot safely operate in winds exceeding 25-30 mph. Strong winds can cause loss of control, reduced battery life, and crashes."
            },
            {
                category: "Weather",
                question: "What is the definition of ceiling in aviation weather?",
                options: [
                    "The highest altitude a drone can reach",
                    "The height of the lowest layer of clouds covering more than half the sky",
                    "The maximum operating altitude",
                    "The top of controlled airspace"
                ],
                correct: 1,
                explanation: "In aviation, ceiling refers to the height above ground level (AGL) of the lowest layer of clouds that covers more than half (broken) or all (overcast) of the sky. This is important for determining visibility and operating conditions."
            },
            {
                category: "Weather",
                question: "What causes advection fog?",
                options: [
                    "Radiation cooling on clear nights",
                    "Warm, moist air moving over a cold surface",
                    "Rising air currents in mountainous terrain",
                    "Thunderstorm activity"
                ],
                correct: 1,
                explanation: "Advection fog forms when warm, moist air moves (advects) over a colder surface, causing the air to cool to its dew point. This commonly occurs in coastal areas when warm air moves over cold ocean water."
            },
            {
                category: "Weather",
                question: "What information is contained in a METAR?",
                options: [
                    "Forecast weather for the next 24 hours",
                    "Current observed weather conditions at an airport",
                    "Long-term climate predictions",
                    "Pilot experience requirements"
                ],
                correct: 1,
                explanation: "METAR (Meteorological Aerodrome Report) is a format for reporting current weather observations at airports. It includes information on wind, visibility, clouds, temperature, dew point, and barometric pressure."
            },
            {
                category: "Weather",
                question: "What does high humidity increase the risk of?",
                options: [
                    "Improved drone performance",
                    "Condensation damage to electronics",
                    "Better battery life",
                    "Enhanced GPS signal"
                ],
                correct: 1,
                explanation: "High humidity increases the risk of condensation forming on or inside electronic components, which can cause short circuits and damage. It can also affect battery performance and reduce overall drone reliability."
            },

            // Regulations & Operating Requirements
            {
                category: "Regulations",
                question: "What is the minimum age to obtain a Part 107 Remote Pilot Certificate?",
                options: [
                    "14 years old",
                    "16 years old",
                    "18 years old",
                    "21 years old"
                ],
                correct: 1,
                explanation: "You must be at least 16 years old to obtain a Part 107 Remote Pilot Certificate. You must also pass the Part 107 knowledge test and undergo TSA vetting."
            },
            {
                category: "Regulations",
                question: "How often must a Part 107 Remote Pilot Certificate be renewed?",
                options: [
                    "Every year",
                    "Every 2 years",
                    "Every 3 years",
                    "Never, it's valid indefinitely"
                ],
                correct: 1,
                explanation: "A Part 107 Remote Pilot Certificate must be renewed every 24 months (2 years). Renewal requires completing an online recurrent training course or retaking the Part 107 knowledge test."
            },
            {
                category: "Regulations",
                question: "What is the maximum groundspeed allowed under Part 107?",
                options: [
                    "87 knots (100 mph)",
                    "100 knots (115 mph)",
                    "50 knots (58 mph)",
                    "No maximum specified"
                ],
                correct: 0,
                explanation: "Part 107.51 limits small unmanned aircraft to a maximum groundspeed of 87 knots (100 mph or 161 km/h). This helps maintain safe separation from other aircraft and ensures the remote pilot maintains adequate control."
            },
            {
                category: "Regulations",
                question: "When must a drone be registered with the FAA?",
                options: [
                    "All drones must be registered",
                    "Only drones weighing more than 0.55 pounds (250 grams)",
                    "Only drones weighing more than 5 pounds",
                    "Registration is optional"
                ],
                correct: 1,
                explanation: "Drones weighing more than 0.55 pounds (250 grams) and less than 55 pounds must be registered with the FAA. The registration number must be displayed on the exterior of the aircraft."
            },
            {
                category: "Regulations",
                question: "Can you fly a drone at night under Part 107?",
                options: [
                    "No, night operations are prohibited",
                    "Yes, with anti-collision lighting visible for 3 statute miles",
                    "Only with a waiver",
                    "Yes, but only in Class G airspace"
                ],
                correct: 1,
                explanation: "As of 2021, night operations are allowed under Part 107 if the remote pilot has completed night training and the drone has anti-collision lighting visible for at least 3 statute miles. Night operations require additional recurrent training."
            },

            // Operations & Flight Planning
            {
                category: "Operations",
                question: "What is the minimum visibility required for Part 107 operations?",
                options: [
                    "1 statute mile",
                    "2 statute miles",
                    "3 statute miles",
                    "5 statute miles"
                ],
                correct: 2,
                explanation: "Part 107 requires a minimum flight visibility of 3 statute miles from the control station. This ensures the remote pilot can see and avoid obstacles, other aircraft, and people on the ground."
            },
            {
                category: "Operations",
                question: "What must you do before each flight?",
                options: [
                    "File a flight plan with ATC",
                    "Conduct a preflight inspection",
                    "Submit a weather report",
                    "Register your drone"
                ],
                correct: 1,
                explanation: "Part 107.49 requires the remote pilot in command to conduct a preflight inspection before each flight, including checking the aircraft and control station for proper operation and any defects that could affect safety."
            },
            {
                category: "Operations",
                question: "How close can you fly to people not directly participating in the operation?",
                options: [
                    "Directly over them at any altitude",
                    "Not directly over them unless they're under a covered structure",
                    "Within 10 feet",
                    "Within 50 feet"
                ],
                correct: 1,
                explanation: "Under Part 107, you cannot operate over people unless they are directly participating in the operation or are under a covered structure or stationary vehicle. Recent rule changes also allow operations over people with drones meeting specific Category 1-4 requirements."
            },
            {
                category: "Operations",
                question: "What is VLOS (Visual Line of Sight)?",
                options: [
                    "Using only the drone's camera feed",
                    "Seeing the drone with unaided vision (except corrective lenses)",
                    "Using binoculars to see the drone",
                    "Maintaining GPS contact"
                ],
                correct: 1,
                explanation: "VLOS means the remote pilot must be able to see the drone with unaided vision (corrective lenses are allowed) throughout the entire flight. This is required under Part 107 to maintain situational awareness and avoid collisions."
            },
            {
                category: "Operations",
                question: "What action should you take if you experience a flyaway?",
                options: [
                    "Wait for the battery to die",
                    "Activate return-to-home if available, attempt to regain control",
                    "Immediately file an accident report",
                    "Continue with your mission"
                ],
                correct: 1,
                explanation: "If experiencing a flyaway (loss of control), attempt to regain control, use return-to-home features if available, and prepare for emergency landing. After regaining control or crash, assess the situation and file reports as required."
            },

            // Loading & Performance
            {
                category: "Loading & Performance",
                question: "What happens to drone performance at high-density altitude?",
                options: [
                    "Performance improves",
                    "Performance decreases (less lift, reduced efficiency)",
                    "No effect on performance",
                    "Only affects battery life"
                ],
                correct: 1,
                explanation: "High-density altitude (high temperature, high elevation, or high humidity) means thinner air. This reduces lift generation and motor efficiency, requiring more power to maintain flight and reducing overall performance and flight time."
            },
            {
                category: "Loading & Performance",
                question: "How does wind affect battery consumption?",
                options: [
                    "Wind has no effect on batteries",
                    "Headwinds increase battery consumption",
                    "Wind improves battery life",
                    "Only crosswinds affect batteries"
                ],
                correct: 1,
                explanation: "Flying into headwinds requires more power to maintain groundspeed and position, significantly increasing battery consumption. Always account for wind when planning flight time and ensure sufficient battery reserve."
            },
            {
                category: "Loading & Performance",
                question: "What is the effect of adding payload weight to a drone?",
                options: [
                    "Increases flight time",
                    "Improves stability",
                    "Reduces flight time and maneuverability",
                    "No effect if under maximum takeoff weight"
                ],
                correct: 2,
                explanation: "Adding payload weight requires more power to maintain flight, reducing flight time. It also affects maneuverability and can change the aircraft's center of gravity, potentially making it unstable. Never exceed the manufacturer's maximum takeoff weight."
            },
            {
                category: "Loading & Performance",
                question: "What is the relationship between temperature and battery performance?",
                options: [
                    "Cold temperatures improve battery performance",
                    "Temperature has no effect",
                    "Cold temperatures reduce battery capacity and performance",
                    "Only hot temperatures affect batteries"
                ],
                correct: 2,
                explanation: "Cold temperatures significantly reduce lithium polymer battery capacity, discharge rate, and overall performance. In freezing conditions, batteries may provide 50% or less of their normal capacity. Pre-warm batteries and monitor voltage closely in cold weather."
            },
            {
                category: "Loading & Performance",
                question: "What is the recommended minimum battery level to return to home?",
                options: [
                    "10%",
                    "20%",
                    "30%",
                    "50%"
                ],
                correct: 2,
                explanation: "Most pilots recommend returning with at least 30% battery remaining to account for unexpected situations like headwinds, navigation errors, or the need to avoid obstacles. Never push your battery to critically low levels."
            },

            // Emergency Procedures
            {
                category: "Emergency Procedures",
                question: "What should you do if you lose GPS signal during flight?",
                options: [
                    "Immediately land",
                    "Switch to ATTI mode if available and carefully return to home",
                    "Continue flying normally",
                    "Activate automatic landing"
                ],
                correct: 1,
                explanation: "Loss of GPS signal means loss of position hold and automated features. If your drone has ATTI (attitude) mode, it will switch to that, requiring manual control. Carefully navigate back to your position and land safely. Avoid complex maneuvers."
            },
            {
                category: "Emergency Procedures",
                question: "When must you report an accident to the FAA?",
                options: [
                    "Any crash or damage",
                    "Serious injury or property damage over $500",
                    "Only if someone dies",
                    "Reporting is optional"
                ],
                correct: 1,
                explanation: "Part 107 requires reporting within 10 days if an operation causes serious injury, loss of consciousness, or property damage (other than to the drone) exceeding $500. Use the FAA's online reporting system."
            },
            {
                category: "Emergency Procedures",
                question: "What is the first priority in an emergency situation?",
                options: [
                    "Protecting the drone",
                    "Completing the mission",
                    "Safety of people and property",
                    "Recording video evidence"
                ],
                correct: 2,
                explanation: "In any emergency, the first priority is always the safety of people and property. The remote pilot in command is responsible for making decisions that prioritize safety, even if it means damaging or losing the aircraft."
            },
            {
                category: "Emergency Procedures",
                question: "What should you do if manned aircraft approaches your operation area?",
                options: [
                    "Maintain altitude and position",
                    "Immediately land or move away from the manned aircraft path",
                    "Flash your lights to warn them",
                    "Continue your mission"
                ],
                correct: 1,
                explanation: "Manned aircraft always have right of way. If a manned aircraft approaches, immediately descend, move away from its path, and land if necessary. Never assume they see you or will avoid you."
            },
            {
                category: "Emergency Procedures",
                question: "What indicates a low battery warning should be taken seriously?",
                options: [
                    "You can ignore it if you're close to home",
                    "It means you may have only minutes of flight time remaining",
                    "It's just a suggestion to land soon",
                    "Modern drones always have 10+ minutes after the warning"
                ],
                correct: 1,
                explanation: "Low battery warnings are critical. Depending on conditions (wind, temperature, altitude), you may have only 1-3 minutes of flight time remaining. Always respond immediately by returning to home or landing in a safe location."
            },

            // Crew Resource Management
            {
                category: "Crew Resource Management",
                question: "What is the purpose of a visual observer (VO)?",
                options: [
                    "To fly the drone when the pilot is tired",
                    "To assist in maintaining VLOS and watching for hazards",
                    "To handle all communication",
                    "Visual observers are not allowed under Part 107"
                ],
                correct: 1,
                explanation: "A visual observer helps the remote pilot maintain VLOS, watches for hazards (aircraft, people, obstacles), and assists in safe operation. The VO must be able to communicate with the remote pilot in command and see the aircraft."
            },
            {
                category: "Crew Resource Management",
                question: "Who has final authority over the flight operation?",
                options: [
                    "The client who hired you",
                    "Air Traffic Control",
                    "The Remote Pilot in Command (RPIC)",
                    "The visual observer"
                ],
                correct: 2,
                explanation: "The Remote Pilot in Command (RPIC) has final authority and responsibility for the operation. They can decline to fly if conditions are unsafe, regardless of pressure from clients or others."
            },
            {
                category: "Crew Resource Management",
                question: "What is the hazardous attitude of 'Get-Home-Itis'?",
                options: [
                    "Being too cautious",
                    "Rushing to complete a mission despite warning signs",
                    "Taking too many breaks",
                    "Following regulations too strictly"
                ],
                correct: 1,
                explanation: "Get-Home-Itis (or 'mission-itis') is the dangerous tendency to rush to complete a mission despite deteriorating conditions, low battery, or other warning signs. This hazardous attitude leads to poor decision-making and accidents."
            },
            {
                category: "Crew Resource Management",
                question: "What should you do if you feel uncomfortable with a requested operation?",
                options: [
                    "Proceed anyway to satisfy the client",
                    "Decline or postpone until conditions are safe",
                    "Have someone else fly for you",
                    "Ignore your instincts"
                ],
                correct: 1,
                explanation: "Trust your instincts. If you're uncomfortable with weather, airspace, or any aspect of the operation, you have the authority and responsibility to decline or postpone. Professional judgment is essential for safe operations."
            },
            {
                category: "Crew Resource Management",
                question: "What is 'normalization of deviance'?",
                options: [
                    "Following all regulations strictly",
                    "Gradually accepting unsafe practices as normal because nothing bad has happened",
                    "Training new pilots",
                    "Updating your knowledge regularly"
                ],
                correct: 1,
                explanation: "Normalization of deviance occurs when unsafe practices become routine because they haven't caused problems yet. Examples include skipping preflight checks, flying in marginal weather, or cutting corners. This attitude eventually leads to accidents."
            },

            // Radio Communication & Airport Operations
            {
                category: "Radio & Airport Operations",
                question: "What does CTAF stand for?",
                options: [
                    "Control Tower Authorization Frequency",
                    "Common Traffic Advisory Frequency",
                    "Certified Technical Aviation Frequency",
                    "Central Terminal Access Frequency"
                ],
                correct: 1,
                explanation: "CTAF (Common Traffic Advisory Frequency) is a radio frequency used at non-towered airports for pilots to communicate their positions and intentions. Monitoring CTAF helps maintain situational awareness of nearby aircraft activity."
            },
            {
                category: "Radio & Airport Operations",
                question: "What is the standard traffic pattern altitude at most airports?",
                options: [
                    "500 feet AGL",
                    "1,000 feet AGL",
                    "1,500 feet AGL",
                    "2,000 feet AGL"
                ],
                correct: 1,
                explanation: "The standard traffic pattern altitude at most airports is 1,000 feet AGL (above ground level). This is important for drone pilots to know when operating near airports, as this is where manned aircraft will be flying during landing and takeoff."
            },
            {
                category: "Radio & Airport Operations",
                question: "What direction do aircraft typically fly in the traffic pattern?",
                options: [
                    "Always clockwise",
                    "Typically left-hand (counterclockwise) unless specified otherwise",
                    "Always right-hand",
                    "No standard pattern"
                ],
                correct: 1,
                explanation: "Most airports use left-hand (counterclockwise) traffic patterns unless a right-hand pattern is specified in the Chart Supplement or by local procedures. This standardization helps prevent collisions and maintain orderly flow."
            },
            {
                category: "Radio & Airport Operations",
                question: "Why should drone pilots monitor local airport frequencies?",
                options: [
                    "It's required by Part 107",
                    "To maintain awareness of manned aircraft activity in the area",
                    "To request permission for each flight",
                    "To report weather conditions"
                ],
                correct: 1,
                explanation: "While not always required, monitoring local airport frequencies (CTAF or tower) when operating near airports helps maintain situational awareness of manned aircraft activity, allowing you to take appropriate action to avoid conflicts."
            },
            {
                category: "Radio & Airport Operations",
                question: "What does a segmented circle at an airport indicate?",
                options: [
                    "The airport is closed",
                    "Traffic pattern information and runway in use",
                    "Military operations area",
                    "Drone operations prohibited"
                ],
                correct: 1,
                explanation: "A segmented circle at an airport displays traffic pattern indicators and wind direction information. It helps pilots determine the active runway and proper traffic pattern direction, especially at non-towered airports."
            },

            // Aeronautical Decision Making
            {
                category: "Decision Making",
                question: "What does the PAVE checklist help assess?",
                options: [
                    "Pilot, Aircraft, enVironment, External pressures",
                    "Plan, Analyze, Verify, Execute",
                    "Position, Altitude, Velocity, Energy",
                    "Preflight, Airspace, Visual observers, Equipment"
                ],
                correct: 0,
                explanation: "The PAVE checklist is a risk management tool: Pilot (skills, fitness), Aircraft (condition, capabilities), enVironment (weather, terrain), and External pressures (time constraints, client expectations). Use it to assess risk before each flight."
            },
            {
                category: "Decision Making",
                question: "What is the IMSAFE checklist used for?",
                options: [
                    "Aircraft inspection",
                    "Assessing personal fitness to fly (Illness, Medication, Stress, Alcohol, Fatigue, Emotion)",
                    "Weather analysis",
                    "Airspace authorization"
                ],
                correct: 1,
                explanation: "IMSAFE assesses personal fitness: Illness, Medication, Stress, Alcohol, Fatigue, Emotion. If any factor impairs your judgment or abilities, you should not operate the drone. Personal fitness is as important as aircraft readiness."
            },
            {
                category: "Decision Making",
                question: "What is the 3P model for decision making?",
                options: [
                    "Plan, Perform, Proceed",
                    "Perceive, Process, Perform",
                    "Prepare, Practice, Perfect",
                    "Position, Power, Pitch"
                ],
                correct: 1,
                explanation: "The 3P model (Perceive, Process, Perform) is a structured approach to aeronautical decision making. Perceive hazards, Process to determine risk and solutions, Perform by taking the safest course of action."
            },
            {
                category: "Decision Making",
                question: "What type of personality trait is 'anti-authority'?",
                options: [
                    "A safe attitude for independent thinking",
                    "A hazardous attitude that rejects rules and regulations",
                    "A required trait for remote pilots",
                    "A neutral personality trait"
                ],
                correct: 1,
                explanation: "Anti-authority is a hazardous attitude where a person resents rules and regulations, thinking 'Don't tell me what to do.' The antidote is recognizing that rules are usually reasonable and designed for safety."
            },
            {
                category: "Decision Making",
                question: "What does the hazardous attitude of 'invulnerability' mean?",
                options: [
                    "Being well-trained and confident",
                    "Believing 'It won't happen to me' and taking unnecessary risks",
                    "Having good insurance coverage",
                    "Following all safety procedures"
                ],
                correct: 1,
                explanation: "Invulnerability is the hazardous attitude of believing 'It won't happen to me.' This leads to taking risks without considering consequences. The antidote is acknowledging that accidents can happen to anyone, including you."
            },

            // Maintenance & Preflight
            {
                category: "Maintenance & Preflight",
                question: "How often should you inspect your drone?",
                options: [
                    "Once a month",
                    "Before every flight",
                    "Only after crashes",
                    "Once a year"
                ],
                correct: 1,
                explanation: "Part 107.49 requires a preflight inspection before each flight. Check propellers, motors, battery, frame, camera gimbal, firmware updates, and control station. Never skip preflight inspections."
            },
            {
                category: "Maintenance & Preflight",
                question: "What should you check on propellers during preflight?",
                options: [
                    "Only that they're attached",
                    "For cracks, chips, or damage; proper installation and tightness",
                    "Just the color",
                    "Only if they look damaged"
                ],
                correct: 1,
                explanation: "Inspect propellers for any cracks, chips, or damage; verify they're securely attached and properly installed (correct rotation direction). Damaged propellers can cause vibration, reduced performance, or catastrophic failure."
            },
            {
                category: "Maintenance & Preflight",
                question: "What is the proper way to store LiPo batteries?",
                options: [
                    "Fully charged",
                    "Completely discharged",
                    "At storage voltage (around 50-60% charge)",
                    "Storage conditions don't matter"
                ],
                correct: 2,
                explanation: "LiPo batteries should be stored at storage voltage (typically 3.8V per cell, about 50-60% charge) in a cool, dry place. Storing fully charged or completely discharged reduces battery lifespan and can be dangerous."
            },
            {
                category: "Maintenance & Preflight",
                question: "What indicates a LiPo battery is damaged and should not be used?",
                options: [
                    "It's more than 1 year old",
                    "Swelling, punctures, or significant voltage imbalance between cells",
                    "It needs to be charged",
                    "The label is worn"
                ],
                correct: 1,
                explanation: "Never use damaged LiPo batteries. Signs include swelling (puffing), punctures, dents, significant voltage imbalance between cells, or a battery that gets very hot during charging or use. Damaged batteries can catch fire."
            },
            {
                category: "Maintenance & Preflight",
                question: "Why is firmware kept up to date?",
                options: [
                    "It's not necessary",
                    "To access new features, improve performance, and fix safety issues",
                    "Only for warranty purposes",
                    "To increase resale value"
                ],
                correct: 1,
                explanation: "Firmware updates often include critical safety fixes, improved stability, bug fixes, and new features. However, read release notes carefully and be cautious with updates right before important missions. Always test after updating."
            },

            // Additional Airspace Questions
            {
                category: "Airspace",
                question: "What color is Class B airspace depicted on sectional charts?",
                options: [
                    "Red",
                    "Blue",
                    "Magenta",
                    "Brown"
                ],
                correct: 1,
                explanation: "Class B airspace is depicted in solid blue on sectional charts. It surrounds the busiest airports and typically extends from the surface to 10,000 feet MSL in a stepped configuration resembling an upside-down wedding cake."
            },
            {
                category: "Airspace",
                question: "What is a TFR?",
                options: [
                    "Total Flight Restriction",
                    "Temporary Flight Restriction",
                    "Terminal Flight Route",
                    "Technical Frequency Range"
                ],
                correct: 1,
                explanation: "A TFR (Temporary Flight Restriction) is airspace restriction issued for security, safety, or special events (presidential movements, sporting events, firefighting). TFRs are published via NOTAM. Violating a TFR is a serious offense."
            },
            {
                category: "Airspace",
                question: "What altitude is Class A airspace?",
                options: [
                    "Surface to 10,000 feet",
                    "10,000 to 18,000 feet MSL",
                    "18,000 feet MSL to Flight Level 600",
                    "Above 60,000 feet"
                ],
                correct: 2,
                explanation: "Class A airspace exists from 18,000 feet MSL to Flight Level 600 (approximately 60,000 feet). It's controlled airspace where all aircraft must operate under IFR and have specific equipment. Drones cannot legally operate in Class A airspace under Part 107."
            },
            {
                category: "Airspace",
                question: "What do the magenta dashed lines around airports on sectional charts indicate?",
                options: [
                    "Class B airspace",
                    "Class C airspace",
                    "Class D airspace",
                    "Restricted airspace"
                ],
                correct: 2,
                explanation: "Magenta dashed lines indicate Class D airspace, which surrounds airports with operating control towers. Class D airspace typically extends from the surface to 2,500 feet AGL. Authorization is required for drone operations."
            },
            {
                category: "Airspace",
                question: "What do solid magenta lines on a sectional chart represent?",
                options: [
                    "Class D airspace",
                    "Class C airspace",
                    "Class E surface area",
                    "Class B airspace"
                ],
                correct: 1,
                explanation: "Solid magenta lines depict Class C airspace on sectional charts. Class C airspace surrounds airports with moderate traffic levels, typically extends from the surface to 4,000 feet above the airport elevation, and requires ATC authorization for drone operations."
            },
            {
                category: "Airspace",
                question: "On a sectional chart, what does a blue segmented line indicate?",
                options: [
                    "Class C airspace",
                    "A MOA (Military Operations Area)",
                    "Mode C veil",
                    "Class B airspace shelf"
                ],
                correct: 2,
                explanation: "A blue segmented line on a sectional chart indicates the Mode C veil, which is a 30-nautical-mile ring around Class B primary airports. Within this area, aircraft must have Mode C transponders. While drones don't need transponders, this helps identify high-traffic areas."
            },
            {
                category: "Airspace",
                question: "What does the blue shading with scalloped edges on a sectional chart indicate?",
                options: [
                    "Class E airspace with a floor of 700 feet AGL",
                    "Class E airspace with a floor of 1,200 feet AGL",
                    "Water bodies",
                    "Restricted areas"
                ],
                correct: 0,
                explanation: "Blue (faded magenta) shading with scalloped edges indicates Class E airspace that begins at 700 feet AGL. This typically surrounds airports with instrument approaches. Drone operations below 400 feet AGL generally do not require authorization in these areas."
            },
            {
                category: "Airspace",
                question: "How is a Military Operations Area (MOA) depicted on sectional charts?",
                options: [
                    "Solid red lines",
                    "Magenta hatched borders with the name in magenta",
                    "Blue dashed lines",
                    "Brown shaded areas"
                ],
                correct: 1,
                explanation: "MOAs are depicted with magenta hatched borders and the MOA name printed in magenta. MOAs are designated airspace for military training activities. While Part 107 operations are allowed in MOAs without authorization, pilots should exercise caution and check NOTAMs for active times."
            },
            {
                category: "Airspace",
                question: "On a sectional chart, what symbol indicates an airport with a control tower?",
                options: [
                    "Blue airport symbol",
                    "Magenta airport symbol",
                    "Green airport symbol",
                    "Red airport symbol"
                ],
                correct: 0,
                explanation: "Airports with operating control towers are depicted in blue on sectional charts. The blue color immediately identifies towered airports, which are surrounded by Class D (or busier) airspace requiring ATC authorization for drone operations."
            },
            {
                category: "Airspace",
                question: "What does a magenta airport symbol indicate on a sectional chart?",
                options: [
                    "Military airport",
                    "Airport with control tower",
                    "Non-towered airport",
                    "Heliport only"
                ],
                correct: 2,
                explanation: "Magenta airport symbols indicate non-towered airports (also called uncontrolled airports). These airports typically have Class G airspace and may have Class E airspace extensions. Always check the Chart Supplement for details on operations, facilities, and traffic patterns."
            },
            {
                category: "Airspace",
                question: "What do the numbers in a sectional chart legend showing '55' over '30' near an airport indicate?",
                options: [
                    "Runway length in hundreds of feet (5,500 ft) over field elevation (3,000 ft MSL)",
                    "Airport frequency over tower frequency",
                    "Traffic pattern altitude over field elevation",
                    "Maximum aircraft weight over minimum visibility"
                ],
                correct: 0,
                explanation: "The top number shows the longest runway length in hundreds of feet (55 = 5,500 feet). The bottom number shows the field elevation in feet MSL (30 = 3,000 feet MSL). This critical information helps pilots assess runway suitability and calculate AGL altitudes."
            },
            {
                category: "Airspace",
                question: "On a sectional chart, what does 'R-2508' indicate?",
                options: [
                    "A restricted area",
                    "A required reporting point",
                    "Runway 25, left pattern",
                    "Radio frequency 250.8"
                ],
                correct: 0,
                explanation: "The 'R-' prefix designates restricted airspace. R-2508 is a specific restricted area where flight is prohibited or restricted due to military operations, hazardous activities, or security. Drone operations in restricted areas are prohibited without specific authorization from the controlling agency."
            },
            {
                category: "Airspace",
                question: "What information can you find in the Chart Supplement (formerly Airport/Facility Directory) for an airport?",
                options: [
                    "Only runway dimensions",
                    "Weather forecasts",
                    "Airport location, elevation, runways, frequencies, services, traffic pattern direction, and remarks",
                    "Pilot certification requirements"
                ],
                correct: 2,
                explanation: "The Chart Supplement provides comprehensive airport information including location coordinates, field elevation, runway data (length, width, surface), communication frequencies, available services (fuel, maintenance), traffic pattern information, operational hours, and important remarks. It's essential for flight planning."
            },
            {
                category: "Airspace",
                question: "In the Chart Supplement, what does 'RP' in the runway description indicate?",
                options: [
                    "Right pattern",
                    "Restricted pavement",
                    "Required permission",
                    "Radar positioning"
                ],
                correct: 0,
                explanation: "RP indicates a right-hand traffic pattern for that runway. Most airports use standard left-hand patterns, but right patterns are designated for specific runways to avoid obstacles, noise-sensitive areas, or conflicting traffic. This information is critical for situational awareness near airports."
            },
            {
                category: "Airspace",
                question: "On a sectional chart, what do brown contour lines represent?",
                options: [
                    "Restricted airspace boundaries",
                    "Terrain elevation and topographic features",
                    "Navigation routes",
                    "Weather pattern lines"
                ],
                correct: 1,
                explanation: "Brown contour lines depict terrain elevation and topographic features on sectional charts. These lines show ground elevation changes and help pilots identify mountains, valleys, and high terrain. This is crucial for understanding true AGL altitudes and avoiding terrain conflicts."
            },
            {
                category: "Airspace",
                question: "What does an Alert Area (depicted as 'A-xxx') on a sectional chart indicate?",
                options: [
                    "Airspace where pilot authorization is required",
                    "Areas with high volume of pilot training or unusual aerial activity where pilots should be particularly alert",
                    "Automated weather stations",
                    "Airspace restricted to military aircraft only"
                ],
                correct: 1,
                explanation: "Alert Areas inform pilots of areas with high volumes of pilot training or unusual aerial activity. While authorization is not required to fly through Alert Areas, pilots should exercise extreme caution and maintain enhanced vigilance for other aircraft."
            },
            {
                category: "Airspace",
                question: "How can you determine the floor and ceiling of Class E airspace shown on a sectional chart?",
                options: [
                    "It's always surface to 18,000 feet MSL",
                    "By the type of shading (no shading = 1,200' AGL floor, blue/faded magenta = 700' AGL floor, magenta shading = surface)",
                    "All Class E starts at 400 feet AGL",
                    "Only indicated in the Chart Supplement"
                ],
                correct: 1,
                explanation: "Class E airspace floors are depicted by different shading on sectional charts: areas with no shading typically have Class E beginning at 1,200' AGL; blue (faded magenta) vignettes with scalloped edges indicate 700' AGL floor; and magenta vignettes indicate surface area Class E extensions requiring authorization."
            },
            {
                category: "Airspace",
                question: "What do the tick marks around an airport on a sectional chart represent?",
                options: [
                    "Landing direction indicators",
                    "Airport services available",
                    "Airspace classification boundaries showing exact dimensions",
                    "Restricted flight zones"
                ],
                correct: 2,
                explanation: "Tick marks (or tabulations) around airports on sectional charts show the precise boundaries of controlled airspace. They indicate the exact lateral limits of Class B, C, D, or E surface areas. This helps pilots determine exactly where authorization is required."
            },
            {
                category: "Airspace",
                question: "On a sectional chart, what does maximum elevation figure (MEF) represent?",
                options: [
                    "Maximum altitude for VFR flight in that quadrangle",
                    "Highest known feature (terrain or obstacle) in that quadrangle section, rounded up to the nearest 100 feet",
                    "Minimum safe altitude for IFR operations",
                    "Maximum altitude ATC will authorize"
                ],
                correct: 1,
                explanation: "The Maximum Elevation Figure (MEF) represents the highest known feature (terrain, obstacles, towers) within a sectional chart quadrangle, rounded up to the nearest 100 feet. MEFs provide terrain clearance information and help pilots avoid controlled flight into terrain (CFIT)."
            },
            {
                category: "Airspace",
                question: "What does a parachute symbol on a sectional chart indicate?",
                options: [
                    "Emergency landing zone",
                    "Parachute jumping area with frequent skydiving activity",
                    "Military parachute training only",
                    "Hang gliding area"
                ],
                correct: 1,
                explanation: "The parachute symbol indicates an area of frequent parachute jumping activity. Drone pilots should avoid these areas when jumps are in progress, as skydivers may be descending from altitudes of 10,000-15,000 feet AGL through all altitude layers including typical drone operating altitudes."
            },
            {
                category: "Airspace",
                question: "In the Chart Supplement, what does 'CTAF 122.9' mean?",
                options: [
                    "Control Tower Authorization Frequency",
                    "Common Traffic Advisory Frequency where pilots self-announce their positions",
                    "Central Terminal Approach Facility",
                    "Cleared To Airport Frequency"
                ],
                correct: 1,
                explanation: "CTAF (Common Traffic Advisory Frequency) is the radio frequency used at non-towered airports for pilots to self-announce their positions and intentions. Drone pilots operating near these airports should monitor CTAF on 122.9 MHz to maintain awareness of manned aircraft traffic."
            },
            {
                category: "Airspace",
                question: "What does the notation 'NSTD' in the Chart Supplement indicate?",
                options: [
                    "No Student Training Designated",
                    "Non-standard traffic pattern, runway information, or procedures in use at the airport",
                    "Night Services Temporarily Discontinued",
                    "New System Technology Deployed"
                ],
                correct: 1,
                explanation: "NSTD means 'Non-Standard' and indicates that non-standard traffic patterns, runway configurations, or procedures are in use. Always read the remarks section carefully when you see NSTD, as it may affect operational safety and require special awareness."
            },
            {
                category: "Airspace",
                question: "On a sectional chart, what do obstacles with the notation '(UC)' indicate?",
                options: [
                    "Under Construction",
                    "Unlighted structure",
                    "Uncontrolled airspace",
                    "Unusable for Climbing"
                ],
                correct: 0,
                explanation: "The (UC) notation next to an obstacle indicates it is 'Under Construction.' These obstacles may not yet appear on the chart or may be incomplete. Always check NOTAMs for the latest information on obstacles under construction, as they represent changing hazards to navigation."
            },
            {
                category: "Airspace",
                question: "What is the significance of a blue airport symbol with a star inside on a sectional chart?",
                options: [
                    "Military base with public access",
                    "International airport",
                    "Airport with rotating beacon and night lighting available",
                    "Five-star service facility"
                ],
                correct: 2,
                explanation: "A star (or asterisk) inside an airport symbol indicates the airport has a rotating beacon operating from sunset to sunrise. This means the airport has lighting facilities and is equipped for night operations, which is valuable information for emergency situations."
            },
            {
                category: "Airspace",
                question: "What does 'RP 27' in the Chart Supplement airport diagram mean?",
                options: [
                    "Recommended Pattern altitude 2,700 feet MSL",
                    "Right traffic pattern for Runway 27",
                    "Restricted Pilot training area 27",
                    "Runway Paint marking 27"
                ],
                correct: 1,
                explanation: "RP 27 indicates a right-hand traffic pattern for Runway 27 (instead of the standard left-hand pattern). This non-standard pattern must be followed by all aircraft. Drone pilots should be aware of these patterns to anticipate manned aircraft positions near airports."
            },

            // Additional Weather Questions
            {
                category: "Weather",
                question: "What is the standard temperature lapse rate?",
                options: [
                    "2¬∞C per 1,000 feet",
                    "3¬∞C per 1,000 feet",
                    "5¬∞C per 1,000 feet",
                    "10¬∞C per 1,000 feet"
                ],
                correct: 0,
                explanation: "The standard temperature lapse rate is approximately 2¬∞C (3.5¬∞F) per 1,000 feet of altitude gain in the troposphere. This means air temperature generally decreases as altitude increases, affecting air density and drone performance."
            },
            {
                category: "Weather",
                question: "What type of weather produces hail, lightning, and severe turbulence?",
                options: [
                    "Stratus clouds",
                    "Cumulus clouds",
                    "Cumulonimbus thunderstorms",
                    "Cirrus clouds"
                ],
                correct: 2,
                explanation: "Cumulonimbus clouds produce thunderstorms with severe weather including hail, lightning, extreme turbulence, heavy rain, and strong winds. Never fly near thunderstorms - they can extend for miles and produce hazardous conditions."
            },
            {
                category: "Weather",
                question: "What causes wind shear?",
                options: [
                    "High humidity",
                    "Sudden changes in wind speed and/or direction over a short distance",
                    "Low barometric pressure",
                    "Cold temperatures"
                ],
                correct: 1,
                explanation: "Wind shear is a sudden change in wind speed and/or direction over a short distance. It can occur near thunderstorms, frontal systems, or due to terrain effects. Wind shear is extremely hazardous for all aircraft, especially small drones."
            },
            {
                category: "Weather",
                question: "What does dew point indicate?",
                options: [
                    "The temperature at which condensation occurs",
                    "The highest temperature of the day",
                    "Wind speed",
                    "Barometric pressure"
                ],
                correct: 0,
                explanation: "Dew point is the temperature at which air becomes saturated and condensation begins. When air temperature and dew point are close (within 4-5¬∞F), fog or low clouds are likely to form. This is important for assessing visibility conditions."
            },

            // Additional Regulations Questions
            {
                category: "Regulations",
                question: "What is the maximum weight for a Part 107 drone?",
                options: [
                    "25 pounds",
                    "55 pounds including payload",
                    "100 pounds",
                    "No weight limit"
                ],
                correct: 1,
                explanation: "Under Part 107, the maximum weight for a small unmanned aircraft is 55 pounds (25 kg) including everything on board (payload, batteries, etc.). Aircraft exceeding this weight require different certification and operating rules."
            },
            {
                category: "Regulations",
                question: "Can you operate from a moving vehicle under Part 107?",
                options: [
                    "No, never",
                    "Yes, but only over sparsely populated areas",
                    "Yes, without restrictions",
                    "Only with a waiver"
                ],
                correct: 1,
                explanation: "Part 107 allows operations from moving vehicles or aircraft only over sparsely populated areas. This helps reduce risk to people and property. Operating from a moving vehicle in populated areas requires a waiver."
            },
            {
                category: "Regulations",
                question: "What documents must you have available during flight operations?",
                options: [
                    "Only your driver's license",
                    "Remote Pilot Certificate and photo ID",
                    "Just the drone registration",
                    "No documents required"
                ],
                correct: 1,
                explanation: "You must have your Remote Pilot Certificate and government-issued photo identification available during operations. These must be presented to FAA inspectors or law enforcement upon request."
            },
            {
                category: "Regulations",
                question: "How long is the Part 107 knowledge test valid before expiring?",
                options: [
                    "12 months",
                    "24 months",
                    "36 months",
                    "It never expires"
                ],
                correct: 1,
                explanation: "The Part 107 knowledge test results are valid for 24 months. Within this period, you must complete the application process to receive your Remote Pilot Certificate, which is then valid for 24 months from issuance."
            },

            // Additional Operations Questions
            {
                category: "Operations",
                question: "What is the minimum distance from clouds required under Part 107?",
                options: [
                    "Clear of clouds",
                    "500 feet below, 1,000 feet above, 2,000 feet horizontally",
                    "500 feet in any direction",
                    "1,000 feet in any direction"
                ],
                correct: 1,
                explanation: "Part 107 requires remaining at least 500 feet below clouds, 1,000 feet above clouds, and 2,000 feet horizontally from clouds. This cloud clearance ensures adequate separation from manned aircraft operating in and around clouds."
            },
            {
                category: "Operations",
                question: "What is a sterile cockpit?",
                options: [
                    "A clean work area",
                    "Avoiding distractions during critical phases of flight",
                    "Operating alone",
                    "Using sanitized equipment"
                ],
                correct: 1,
                explanation: "Sterile cockpit refers to avoiding non-essential activities and distractions during critical phases of flight (takeoff, landing, or when dealing with problems). This helps maintain focus and reduces the risk of errors."
            },
            {
                category: "Operations",
                question: "What should you consider when planning a flight near wildlife?",
                options: [
                    "Wildlife is not a concern",
                    "Avoid disturbing wildlife; some areas have specific restrictions",
                    "Only consider during nesting season",
                    "Wildlife will always avoid drones"
                ],
                correct: 1,
                explanation: "Many areas have restrictions on drone operations near wildlife, especially during nesting season. Drones can disturb wildlife, causing stress or abandonment of nests. Research local regulations and maintain appropriate distances from animals."
            },

            // Additional Decision Making Questions
            {
                category: "Decision Making",
                question: "What is 'machoism' in the context of hazardous attitudes?",
                options: [
                    "Being confident and skilled",
                    "Thinking 'I can do it' and taking unnecessary risks to prove ability",
                    "Following proper procedures",
                    "Working with a team"
                ],
                correct: 1,
                explanation: "Machoism is the hazardous attitude of taking risks to prove you can handle anything - 'I can do it.' This leads to showing off or accepting unnecessary challenges. The antidote is acknowledging that taking chances is foolish."
            },
            {
                category: "Decision Making",
                question: "What is 'resignation' as a hazardous attitude?",
                options: [
                    "Quitting flying",
                    "Thinking 'What's the use?' and not taking action when needed",
                    "Being calm under pressure",
                    "Following instructions carefully"
                ],
                correct: 1,
                explanation: "Resignation is the hazardous attitude of thinking 'What's the use?' and believing you can't make a difference. This leads to passivity when action is needed. The antidote is realizing you're not helpless and can make a difference."
            },

            // Night Operations (NEW SECTION)
            {
                category: "Night Operations",
                question: "What lighting is required for night operations under Part 107?",
                options: [
                    "No lighting is required",
                    "Anti-collision lighting visible for at least 3 statute miles",
                    "White strobe lights only",
                    "Landing lights"
                ],
                correct: 1,
                explanation: "Part 107.29 requires that small unmanned aircraft operated at night must have anti-collision lighting visible for at least 3 statute miles. The lighting must have a flash rate sufficient to avoid collision."
            },
            {
                category: "Night Operations",
                question: "When can you legally operate a drone at night under Part 107?",
                options: [
                    "Never - night operations are prohibited",
                    "Anytime with proper anti-collision lighting",
                    "Only with a waiver",
                    "Only in Class G airspace"
                ],
                correct: 1,
                explanation: "As of April 2021, Part 107 allows night operations if the drone has proper anti-collision lighting visible for 3 statute miles and the remote pilot has completed updated night operations training or passed the recurrent knowledge test after April 6, 2021."
            },
            {
                category: "Night Operations",
                question: "What additional training is required for night operations?",
                options: [
                    "No additional training required",
                    "Initial or recurrent training that addresses night operations",
                    "A separate night operations certificate",
                    "Only a Part 61 pilot certificate"
                ],
                correct: 1,
                explanation: "Remote pilots must complete initial or recurrent training that addresses night operations, or pass the Part 107 knowledge test on or after April 6, 2021. This ensures pilots understand the unique challenges of night flying."
            },
            {
                category: "Night Operations",
                question: "What is the minimum visibility required for night operations?",
                options: [
                    "1 statute mile",
                    "2 statute miles",
                    "3 statute miles",
                    "5 statute miles"
                ],
                correct: 2,
                explanation: "Part 107 requires a minimum visibility of 3 statute miles from the control station during night operations. This is the same requirement as daytime operations."
            },
            {
                category: "Night Operations",
                question: "What color should anti-collision lights be for night operations?",
                options: [
                    "Must be white only",
                    "Must be red only",
                    "Can be any color visible for 3 statute miles",
                    "Must be alternating red and white"
                ],
                correct: 2,
                explanation: "Part 107 does not specify a color requirement for anti-collision lighting. The key requirement is that it must be visible for at least 3 statute miles and have a sufficient flash rate to avoid collision."
            },
            {
                category: "Night Operations",
                question: "What is 'civil twilight' and why is it important for Part 107 operations?",
                options: [
                    "The time when streetlights turn on",
                    "30 minutes before sunrise to 30 minutes after sunset",
                    "The period from sunset to sunrise",
                    "When visibility drops below 5 miles"
                ],
                correct: 1,
                explanation: "Civil twilight is officially defined as 30 minutes before official sunrise and 30 minutes after official sunset. Operations outside civil twilight are considered night operations and require anti-collision lighting and appropriate training."
            },

            // Operations Over People (NEW SECTION)
            {
                category: "Operations Over People",
                question: "Under Part 107, which category of small unmanned aircraft can fly over people without additional requirements?",
                options: [
                    "Category 1",
                    "Category 2",
                    "Category 3",
                    "All categories can fly over people freely"
                ],
                correct: 0,
                explanation: "Category 1 aircraft (weighing 0.55 pounds or less including payload) can operate over people without additional requirements. They pose minimal injury risk due to their light weight."
            },
            {
                category: "Operations Over People",
                question: "What is the maximum weight for a Category 1 aircraft?",
                options: [
                    "0.25 pounds",
                    "0.55 pounds",
                    "1.0 pound",
                    "2.0 pounds"
                ],
                correct: 1,
                explanation: "Category 1 aircraft must weigh 0.55 pounds (250 grams) or less, including everything on board or attached during flight. This weight limit ensures minimal risk of injury to people below."
            },
            {
                category: "Operations Over People",
                question: "What must a Category 2 aircraft have to fly over people?",
                options: [
                    "Nothing - any drone can be Category 2",
                    "Declaration of Compliance submitted to FAA",
                    "Waiver from the FAA",
                    "Remote ID only"
                ],
                correct: 1,
                explanation: "Category 2 aircraft must have a Declaration of Compliance on file with the FAA demonstrating that the aircraft will not cause injury exceeding 11 foot-pounds of kinetic energy threshold upon impact, has no exposed rotating parts causing lacerations, and passes other safety requirements."
            },
            {
                category: "Operations Over People",
                question: "Can you operate over moving vehicles under Part 107?",
                options: [
                    "Yes, always without restrictions",
                    "No, never allowed",
                    "Yes, under certain conditions including not operating over open-air assemblies",
                    "Only with a waiver"
                ],
                correct: 2,
                explanation: "Operations over moving vehicles are allowed for Category 1, 2, 3, or 4 aircraft if not operated over open-air assemblies of human beings, and participants are on notice that a drone may fly over them. Operations must not involve sustained flight over moving vehicles."
            },
            {
                category: "Operations Over People",
                question: "What is an 'open-air assembly' under Part 107?",
                options: [
                    "Any group of 3 or more people",
                    "Any outdoor gathering",
                    "An outdoor gathering where people don't have opportunities to seek shelter",
                    "Only stadiums and concert venues"
                ],
                correct: 2,
                explanation: "An open-air assembly is an outdoor gathering of people where they are largely unable to leave or seek shelter. Examples include sporting events, concerts, festivals, and demonstrations. Operations over open-air assemblies require specific categorical compliance."
            },
            {
                category: "Operations Over People",
                question: "What is Category 3 for operations over people?",
                options: [
                    "Aircraft that can cause injury up to 11 foot-pounds",
                    "Aircraft that can cause injury up to 25 foot-pounds with no exposed rotating parts",
                    "Any aircraft with Remote ID",
                    "Recreational aircraft only"
                ],
                correct: 1,
                explanation: "Category 3 aircraft must not cause injury exceeding the severity threshold of 25 foot-pounds of kinetic energy, must have no exposed rotating parts that would lacerate human skin, and must have a Declaration of Compliance submitted to the FAA."
            },
            {
                category: "Operations Over People",
                question: "Are all Category 2 and 3 aircraft required to have Remote ID?",
                options: [
                    "No, Remote ID is optional",
                    "Only Category 3 requires Remote ID",
                    "Yes, both Category 2 and 3 require Remote ID",
                    "Only operations over people require Remote ID"
                ],
                correct: 2,
                explanation: "All Category 2 and Category 3 small unmanned aircraft must be equipped with Remote ID broadcast capability. Category 1 aircraft may rely on standard Remote ID rules (built-in or broadcast module)."
            },

            // Additional Loading & Performance Questions
            {
                category: "Loading & Performance",
                question: "What happens to aircraft performance as temperature increases?",
                options: [
                    "Performance improves",
                    "Performance decreases due to lower air density",
                    "Temperature has no effect on performance",
                    "Only affects night operations"
                ],
                correct: 1,
                explanation: "As temperature increases, air density decreases, which reduces aircraft performance. Motors work harder, battery efficiency decreases, and lift is reduced. This is especially critical on hot days at high altitudes."
            },
            {
                category: "Loading & Performance",
                question: "What effect does high altitude have on battery performance?",
                options: [
                    "Batteries perform better at high altitude",
                    "Altitude has no effect on batteries",
                    "Batteries drain faster due to lower air density requiring more power",
                    "Only affects cold weather operations"
                ],
                correct: 2,
                explanation: "At high altitudes, the air is less dense, requiring motors to work harder to generate lift. This causes batteries to drain faster and reduces flight time. Pilots must plan for shorter flight times at higher elevations."
            },
            {
                category: "Loading & Performance",
                question: "What is the relationship between center of gravity (CG) and aircraft stability?",
                options: [
                    "CG position doesn't affect stability",
                    "Forward CG increases stability but reduces maneuverability",
                    "Aft CG always improves performance",
                    "CG only matters for fixed-wing aircraft"
                ],
                correct: 1,
                explanation: "A forward center of gravity increases stability but makes the aircraft less maneuverable and requires more power. An aft CG reduces stability and can make the aircraft difficult or impossible to control. Proper CG is critical for safe flight."
            },
            {
                category: "Loading & Performance",
                question: "How does adding a payload affect flight time?",
                options: [
                    "Payload has no effect on flight time",
                    "Heavier payloads decrease flight time due to increased power requirements",
                    "Heavier payloads always improve stability",
                    "Only matters for commercial operations"
                ],
                correct: 1,
                explanation: "Adding payload increases the aircraft's weight, requiring more power to maintain flight. This drains the battery faster and significantly reduces flight time. Always calculate expected flight time when carrying payloads."
            },
            {
                category: "Loading & Performance",
                question: "What is 'density altitude' and why does it matter?",
                options: [
                    "The altitude shown on GPS",
                    "Pressure altitude corrected for non-standard temperature; affects performance",
                    "The altitude of clouds",
                    "Only important for manned aircraft"
                ],
                correct: 1,
                explanation: "Density altitude is pressure altitude corrected for temperature. High density altitude (hot temperatures, high elevation, or high humidity) means thin air, which significantly degrades aircraft performance. Calculate density altitude before flight in challenging conditions."
            },

            // Additional Emergency Procedures Questions
            {
                category: "Emergency Procedures",
                question: "What is the first action if you lose GPS signal during flight?",
                options: [
                    "Immediately land wherever you are",
                    "Switch to ATTI/Manual mode and maintain visual control",
                    "Activate Return to Home",
                    "Turn off the aircraft"
                ],
                correct: 1,
                explanation: "If GPS is lost, the aircraft will typically switch to ATTI (Attitude) mode where it cannot hold position automatically. Maintain visual contact, use manual control, and carefully navigate to a safe landing location. RTH will not work without GPS."
            },
            {
                category: "Emergency Procedures",
                question: "What should you do if your aircraft begins uncontrolled descent?",
                options: [
                    "Increase throttle and try to regain control",
                    "Turn off the controller",
                    "Wait for automatic recovery",
                    "Throw objects at it to stop it"
                ],
                correct: 0,
                explanation: "During uncontrolled descent, attempt to increase throttle to regain control. If unsuccessful, try to steer away from people and property. Maintain visual contact and be prepared to warn people below if necessary."
            },
            {
                category: "Emergency Procedures",
                question: "What is a 'flyaway' and what causes it?",
                options: [
                    "Normal return to home",
                    "Aircraft flying uncontrollably away from the pilot, often due to compass error or GPS issues",
                    "When the pilot flies too far away",
                    "A training exercise"
                ],
                correct: 1,
                explanation: "A flyaway occurs when the aircraft flies away uncontrollably, often due to compass interference, GPS errors, or software glitches. Prevention includes proper compass calibration, checking for interference sources, and maintaining visual line of sight."
            },
            {
                category: "Emergency Procedures",
                question: "If you experience intermittent video signal loss, what should you do?",
                options: [
                    "Continue flying normally",
                    "Return the aircraft to a closer position and check for interference",
                    "Fly higher to improve signal",
                    "Land immediately wherever you are"
                ],
                correct: 1,
                explanation: "Intermittent video loss indicates signal problems. Return the aircraft closer to your position, check for interference sources (WiFi, power lines, other RF sources), and ensure your antenna is properly positioned. Don't fly beyond reliable video range."
            },
            {
                category: "Emergency Procedures",
                question: "What emergency procedure should be followed for a motor failure?",
                options: [
                    "The aircraft will automatically compensate",
                    "Attempt controlled descent to a safe landing area; multi-rotor drones cannot sustain flight with motor failure",
                    "Increase throttle to maximum",
                    "Activate return to home"
                ],
                correct: 1,
                explanation: "Unlike helicopters which can autorotate, multi-rotor drones cannot sustain flight with a motor failure. Try to control the descent as much as possible and steer toward a safe landing area away from people and property."
            },
            {
                category: "Emergency Procedures",
                question: "What should you check if the aircraft is drifting without control input?",
                options: [
                    "Nothing - drifting is normal",
                    "Compass calibration and GPS signal strength",
                    "Battery level only",
                    "Wind speed"
                ],
                correct: 1,
                explanation: "Unexpected drifting often indicates compass errors or poor GPS signal. Check compass calibration, GPS satellite count, and look for magnetic interference. Also verify you're not in ATTI mode. Land and recalibrate if problems persist."
            },

            // Additional Radio Communication Questions
            {
                category: "Radio & Airport Operations",
                question: "What is the CTAF frequency used for?",
                options: [
                    "Emergency communications only",
                    "Common Traffic Advisory Frequency for pilots to announce positions at non-towered airports",
                    "Contacting Air Traffic Control",
                    "Weather information"
                ],
                correct: 1,
                explanation: "CTAF (Common Traffic Advisory Frequency) is used at non-towered airports for pilots to self-announce their positions and intentions. Drone pilots operating near airports should monitor CTAF to maintain awareness of manned aircraft traffic."
            },
            {
                category: "Radio & Airport Operations",
                question: "What does 'downwind' mean in the airport traffic pattern?",
                options: [
                    "Flying into the wind",
                    "Flying parallel to the runway in the opposite direction of landing",
                    "Taxiing on the runway",
                    "Emergency landing"
                ],
                correct: 1,
                explanation: "The downwind leg is flown parallel to the runway in the opposite direction of landing, typically at pattern altitude. Understanding traffic patterns helps drone pilots anticipate where manned aircraft will be when operating near airports."
            },
            {
                category: "Radio & Airport Operations",
                question: "If you hear 'Cessna 123 is on final for runway 27,' what does this mean?",
                options: [
                    "The aircraft is taxiing",
                    "The aircraft is aligned with runway 27 for landing",
                    "The aircraft is taking off",
                    "The aircraft is in the parking area"
                ],
                correct: 1,
                explanation: "'On final' means the aircraft is on final approach, aligned with the runway and descending for landing. This is a critical phase of flight, and drone pilots must ensure they are clear of the approach path."
            },

            // Additional Regulations Questions
            {
                category: "Regulations",
                question: "What is Remote ID and when is it required?",
                options: [
                    "An optional feature for tracking",
                    "Required for all Part 107 operations as of September 16, 2023",
                    "Only required for operations over people",
                    "Not required under Part 107"
                ],
                correct: 1,
                explanation: "Remote ID became mandatory for Part 107 operations on September 16, 2023. It broadcasts identification and location information, allowing the FAA and law enforcement to identify drones in flight. Limited exceptions exist for operations in FAA-recognized identification areas (FRIAs)."
            },
            {
                category: "Regulations",
                question: "What are the two types of Remote ID?",
                options: [
                    "Standard and Extended",
                    "Standard Remote ID and Broadcast Module",
                    "Internal and External",
                    "Basic and Advanced"
                ],
                correct: 1,
                explanation: "Standard Remote ID is built into the aircraft at manufacture. Broadcast modules are aftermarket devices that can be attached to drones manufactured before Remote ID requirements. Both meet the Remote ID requirement."
            },
            {
                category: "Regulations",
                question: "What is an FRIA (FAA-Recognized Identification Area)?",
                options: [
                    "Where Remote ID is not required",
                    "Federal restricted airspace",
                    "Foreign territory",
                    "Flight restricted investigation area"
                ],
                correct: 0,
                explanation: "FRIAs are FAA-Recognized Identification Areas where drones without Remote ID can operate. These are typically established at community-based organization flying sites. Operations must remain within the boundaries of the FRIA."
            },
            {
                category: "Regulations",
                question: "What information does Remote ID broadcast?",
                options: [
                    "Only the drone's location",
                    "Drone ID, location, altitude, velocity, and control station location",
                    "Pilot's name and address",
                    "Video feed from the drone"
                ],
                correct: 1,
                explanation: "Remote ID broadcasts the drone's identification number, location, altitude, velocity, time mark, and emergency status. Standard Remote ID also broadcasts the control station location. This information is available to the FAA and law enforcement."
            },
            {
                category: "Regulations",
                question: "What is the maximum allowed takeoff weight under Part 107?",
                options: [
                    "25 pounds",
                    "35 pounds",
                    "55 pounds",
                    "100 pounds"
                ],
                correct: 2,
                explanation: "Part 107 allows operations of small unmanned aircraft weighing less than 55 pounds at takeoff, including everything on board or attached to the aircraft. This includes the aircraft, payload, and any attachments."
            },
            {
                category: "Regulations",
                question: "Can you operate multiple drones simultaneously under Part 107?",
                options: [
                    "Yes, as many as you want",
                    "No, never allowed",
                    "Yes, but only one drone at a time without a waiver",
                    "Only with multiple remote pilots"
                ],
                correct: 2,
                explanation: "Part 107 normally requires one remote pilot per aircraft. Operating multiple drones simultaneously requires either multiple remote pilots or a waiver from the FAA. Some waivers allow single-pilot multi-drone operations under specific conditions."
            },

            // Additional comprehensive coverage questions
            {
                category: "Operations",
                question: "What is the minimum distance you must maintain from non-participating persons during operations?",
                options: [
                    "No minimum distance required",
                    "Cannot fly directly over them unless they're under a covered structure or inside a stationary vehicle",
                    "Must maintain 100 feet distance",
                    "Must maintain 500 feet distance"
                ],
                correct: 1,
                explanation: "Under Part 107, you cannot fly directly over non-participating persons unless they are under a covered structure or inside a stationary vehicle. Operations over people require Category 1-4 aircraft compliance."
            },
            {
                category: "Weather",
                question: "What weather phenomenon poses the greatest immediate hazard to small unmanned aircraft?",
                options: [
                    "Light rain",
                    "Thunderstorms with lightning, strong winds, and turbulence",
                    "Fog at ground level",
                    "Light snow"
                ],
                correct: 1,
                explanation: "Thunderstorms are extremely hazardous, producing lightning (electrical damage), strong gusty winds (loss of control), heavy precipitation (sensor failures), and severe turbulence. Never fly near or under thunderstorms."
            },
            {
                category: "Loading & Performance",
                question: "How does weight affect the stall speed of a fixed-wing unmanned aircraft?",
                options: [
                    "Weight has no effect on stall speed",
                    "Increased weight increases stall speed",
                    "Increased weight decreases stall speed",
                    "Only affects multi-rotor aircraft"
                ],
                correct: 1,
                explanation: "For fixed-wing aircraft, increased weight requires higher airspeed to generate sufficient lift, thus increasing stall speed. Pilots must maintain higher speeds when operating heavier aircraft to avoid stalling."
            },
            {
                category: "Regulations",
                question: "How often must you renew your Part 107 Remote Pilot Certificate?",
                options: [
                    "Every 12 months",
                    "Every 24 months",
                    "Every 36 months",
                    "It never expires"
                ],
                correct: 1,
                explanation: "Part 107 Remote Pilot Certificates are valid for 24 months (2 years). Renewal requires passing the recurrent knowledge test or completing approved recurrent training through the FAA Safety Team (FAASTeam)."
            },
            {
                category: "Operations",
                question: "What does 'Visual Line of Sight' (VLOS) mean under Part 107?",
                options: [
                    "Viewing through FPV goggles only",
                    "Ability to see the aircraft with your own eyes (with corrective lenses if needed), without aid of any device",
                    "Using binoculars to see the aircraft",
                    "Viewing on a screen"
                ],
                correct: 1,
                explanation: "VLOS requires the remote pilot to see the aircraft with their own eyes (corrective lenses allowed), without aid of binoculars, FPV goggles, or other vision-enhancing devices. This ensures situational awareness and ability to see other aircraft."
            },
            {
                category: "Night Operations",
                question: "What must you ensure about anti-collision lighting visibility?",
                options: [
                    "Visible for 1 statute mile",
                    "Visible for 3 statute miles and has sufficient flash rate",
                    "Visible for 5 statute miles",
                    "Only needs to be visible to the pilot"
                ],
                correct: 1,
                explanation: "Part 107.29 requires anti-collision lighting to be visible for at least 3 statute miles and have a flash rate sufficient to avoid a collision. This ensures other aircraft and people can see your drone during night operations."
            }
        ];

        // Quiz State
        let currentQuestionIndex = 0;
        let correctAnswers = 0;
        let selectedAnswer = null;
        let userAnswers = [];

        // Shuffle array function
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }

        // Start Quiz
        function startQuiz() {
            document.getElementById('startScreen').style.display = 'none';
            document.getElementById('quizScreen').style.display = 'block';
            loadQuestion();
        }

        // Load Question
        function loadQuestion() {
            const question = questions[currentQuestionIndex];
            selectedAnswer = null;

            // Update header
            document.getElementById('category').textContent = question.category;
            document.getElementById('questionText').textContent = question.question;
            document.getElementById('currentQuestion').textContent = currentQuestionIndex + 1;

            // Clear and populate options
            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';

            const letters = ['A', 'B', 'C', 'D'];
            question.options.forEach((option, index) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'option';
                optionDiv.onclick = () => selectAnswer(index);
                optionDiv.innerHTML = `
                    <div class="option-letter">${letters[index]}</div>
                    <div class="option-text">${option}</div>
                `;
                optionsContainer.appendChild(optionDiv);
            });

            // Hide feedback
            document.getElementById('feedback').classList.remove('show');

            // Update stats
            updateStats();

            // Update navigation buttons
            document.getElementById('prevBtn').disabled = currentQuestionIndex === 0;
            document.getElementById('nextBtn').disabled = true;
        }

        // Select Answer
        function selectAnswer(index) {
            if (selectedAnswer !== null) return; // Already answered

            selectedAnswer = index;
            const question = questions[currentQuestionIndex];
            const isCorrect = index === question.correct;

            // Store answer
            userAnswers[currentQuestionIndex] = {
                selected: index,
                correct: question.correct,
                isCorrect: isCorrect
            };

            if (isCorrect) {
                correctAnswers++;
            }

            // Update option styling
            const options = document.querySelectorAll('.option');
            options.forEach((option, i) => {
                if (i === question.correct) {
                    option.classList.add('correct');
                } else if (i === index && !isCorrect) {
                    option.classList.add('incorrect');
                }
                option.style.pointerEvents = 'none';
            });

            // Show feedback
            showFeedback(isCorrect, question);

            // Enable next button
            document.getElementById('nextBtn').disabled = false;

            // Update stats
            updateStats();
        }

        // Show Feedback
        function showFeedback(isCorrect, question) {
            const feedback = document.getElementById('feedback');
            feedback.className = 'feedback show ' + (isCorrect ? 'correct' : 'incorrect');

            const encouragement = isCorrect 
                ? ['Excellent!', 'Great job!', 'Perfect!', 'Well done!', 'Outstanding!', 'Awesome!'][Math.floor(Math.random() * 6)]
                : ['Good try!', 'Keep learning!', 'You\'re getting there!', 'Nice effort!', 'Almost!'][Math.floor(Math.random() * 5)];

            const correctAnswerText = question.options[question.correct];

            feedback.innerHTML = `
                <div class="feedback-title">${encouragement}</div>
                <div class="feedback-message">
                    ${isCorrect 
                        ? 'That\'s the correct answer!' 
                        : `The correct answer is: <strong>${correctAnswerText}</strong>`
                    }
                </div>
                <div class="explanation">
                    üí° <strong>Explanation:</strong> ${question.explanation}
                </div>
            `;
        }

        // Update Stats
        function updateStats() {
            const answered = userAnswers.filter(a => a !== undefined).length;
            const progress = (answered / questions.length) * 100;
            const score = answered > 0 ? Math.round((correctAnswers / answered) * 100) : 0;

            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('progressBar').textContent = Math.round(progress) + '%';
            document.getElementById('correctCount').textContent = correctAnswers;
            document.getElementById('scorePercent').textContent = score + '%';
        }

        // Next Question
        function nextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                loadQuestion();
            } else {
                showResults();
            }
        }

        // Previous Question
        function previousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                
                // If we already answered this question, restore the answer
                if (userAnswers[currentQuestionIndex]) {
                    const previousAnswer = userAnswers[currentQuestionIndex];
                    selectedAnswer = previousAnswer.selected;
                }
                
                loadQuestion();

                // If question was answered, show the selection
                if (selectedAnswer !== null) {
                    const question = questions[currentQuestionIndex];
                    const options = document.querySelectorAll('.option');
                    
                    options.forEach((option, i) => {
                        if (i === question.correct) {
                            option.classList.add('correct');
                        } else if (i === selectedAnswer && !previousAnswer.isCorrect) {
                            option.classList.add('incorrect');
                        }
                        option.style.pointerEvents = 'none';
                    });

                    showFeedback(previousAnswer.isCorrect, question);
                    document.getElementById('nextBtn').disabled = false;
                }
            }
        }

        // Show Results
        function showResults() {
            document.getElementById('quizScreen').style.display = 'none';
            document.getElementById('resultsScreen').classList.add('show');

            const totalQuestions = questions.length;
            const scorePercent = Math.round((correctAnswers / totalQuestions) * 100);

            document.getElementById('finalScore').textContent = scorePercent + '%';
            document.getElementById('totalAnswered').textContent = totalQuestions;
            document.getElementById('totalCorrect').textContent = correctAnswers;
            document.getElementById('totalIncorrect').textContent = totalQuestions - correctAnswers;

            let message = '';
            if (scorePercent >= 90) {
                message = 'üéâ Outstanding! You\'re ready for the Part 107 exam! Your knowledge is excellent and you demonstrate a strong understanding of all the key concepts. Keep up the great work!';
            } else if (scorePercent >= 80) {
                message = 'üåü Great job! You\'re almost there! With a bit more study in the areas you missed, you\'ll be fully prepared for the exam. Review the explanations and try again!';
            } else if (scorePercent >= 70) {
                message = 'üìö Good progress! You understand many concepts, but there\'s room for improvement. Focus on the areas where you struggled and review the explanations carefully. The passing score for the actual exam is 70%, so you\'re on the right track!';
            } else if (scorePercent >= 60) {
                message = 'üí™ Keep studying! You\'re building your knowledge, but need more practice. Review each topic thoroughly and understand the reasoning behind each answer. You can do this!';
            } else {
                message = 'üìñ Don\'t give up! This is a complex exam covering many topics. Take time to study each subject area, review the explanations, and take the quiz again. Every expert was once a beginner!';
            }

            document.getElementById('resultsMessage').textContent = message;
            
            // Initialize performance charts
            initializePerformanceCharts();
        }

        // Restart Quiz
        function restartQuiz() {
            currentQuestionIndex = 0;
            correctAnswers = 0;
            selectedAnswer = null;
            userAnswers = [];

            document.getElementById('resultsScreen').classList.remove('show');
            document.getElementById('quizScreen').style.display = 'block';
            
            loadQuestion();
        }

        // Initialize on page load
        window.onload = function() {
            // Questions are already loaded in order
            console.log(`Loaded ${questions.length} questions for Part 107 study guide`);
            
            // Initialize category chart on start screen
            initializeCategoryChart();
        };

        // Initialize Category Distribution Chart (Custom Canvas Implementation)
        function initializeCategoryChart() {
            const categoryCount = {};
            questions.forEach(q => {
                categoryCount[q.category] = (categoryCount[q.category] || 0) + 1;
            });

            const canvas = document.getElementById('categoryChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            const width = canvas.width = canvas.offsetWidth * 2; // Retina support
            const height = canvas.height = canvas.offsetHeight * 2;
            ctx.scale(2, 2);
            
            const colors = [
                '#2196F3', '#FF9800', '#4CAF50', '#F44336', '#9C27B0',
                '#00BCD4', '#FFC107', '#E91E63', '#795548', '#607D8B'
            ];
            
            const categories = Object.keys(categoryCount);
            const values = Object.values(categoryCount);
            const total = values.reduce((a, b) => a + b, 0);
            
            // Draw donut chart
            const centerX = width / 4;
            const centerY = height / 4 - 40;
            const radius = Math.min(width, height) / 6;
            const innerRadius = radius * 0.5;
            
            let currentAngle = -Math.PI / 2;
            
            categories.forEach((category, i) => {
                const sliceAngle = (values[i] / total) * 2 * Math.PI;
                
                // Draw slice
                ctx.beginPath();
                ctx.arc(centerX, centerY, radius, currentAngle, currentAngle + sliceAngle);
                ctx.arc(centerX, centerY, innerRadius, currentAngle + sliceAngle, currentAngle, true);
                ctx.closePath();
                ctx.fillStyle = colors[i % colors.length];
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.stroke();
                
                currentAngle += sliceAngle;
            });
            
            // Draw legend
            const legendY = height / 2 - 40;
            const legendX = 20;
            categories.forEach((category, i) => {
                const y = legendY + i * 25;
                
                // Color box
                ctx.fillStyle = colors[i % colors.length];
                ctx.fillRect(legendX, y, 15, 15);
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 1;
                ctx.strokeRect(legendX, y, 15, 15);
                
                // Text
                ctx.fillStyle = '#333';
                ctx.font = '12px Arial';
                ctx.fillText(`${category}: ${values[i]}`, legendX + 20, y + 12);
            });
        }

        // Initialize Performance Charts (Custom Canvas Implementation)
        function initializePerformanceCharts() {
            // Calculate performance by category
            const categoryStats = {};
            questions.forEach((q, index) => {
                if (!categoryStats[q.category]) {
                    categoryStats[q.category] = { correct: 0, total: 0 };
                }
                categoryStats[q.category].total++;
                if (userAnswers[index] && userAnswers[index].isCorrect) {
                    categoryStats[q.category].correct++;
                }
            });

            // Performance by Category Bar Chart
            const perfCanvas = document.getElementById('performanceChart');
            if (perfCanvas) {
                const ctx = perfCanvas.getContext('2d');
                const width = perfCanvas.width = perfCanvas.offsetWidth * 2;
                const height = perfCanvas.height = perfCanvas.offsetHeight * 2;
                ctx.scale(2, 2);
                
                const categories = Object.keys(categoryStats).sort();
                const percentages = categories.map(cat => 
                    (categoryStats[cat].correct / categoryStats[cat].total) * 100
                );
                
                const chartWidth = width / 2 - 60;
                const chartHeight = height / 2 - 80;
                const barWidth = chartWidth / categories.length - 5;
                const startX = 40;
                const startY = height / 2 - 50;
                
                // Draw axes
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.moveTo(startX, startY - chartHeight);
                ctx.lineTo(startX, startY);
                ctx.lineTo(startX + chartWidth, startY);
                ctx.stroke();
                
                // Draw bars
                categories.forEach((cat, i) => {
                    const barHeight = (percentages[i] / 100) * chartHeight;
                    const x = startX + i * (barWidth + 5) + 5;
                    const y = startY - barHeight;
                    
                    // Color based on score
                    const p = percentages[i];
                    ctx.fillStyle = p >= 90 ? '#4CAF50' :
                                   p >= 80 ? '#8BC34A' :
                                   p >= 70 ? '#FFC107' :
                                   p >= 60 ? '#FF9800' : '#F44336';
                    
                    ctx.fillRect(x, y, barWidth, barHeight);
                    ctx.strokeStyle = '#1a1a1a';
                    ctx.lineWidth = 1;
                    ctx.strokeRect(x, y, barWidth, barHeight);
                    
                    // Value label
                    ctx.fillStyle = '#333';
                    ctx.font = 'bold 10px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(Math.round(percentages[i]) + '%', x + barWidth/2, y - 5);
                    
                    // Category label (rotated)
                    ctx.save();
                    ctx.translate(x + barWidth/2, startY + 10);
                    ctx.rotate(-Math.PI / 4);
                    ctx.font = '9px Arial';
                    ctx.textAlign = 'right';
                    ctx.fillText(cat, 0, 0);
                    ctx.restore();
                });
                
                // Y-axis labels
                ctx.fillStyle = '#666';
                ctx.font = '10px Arial';
                ctx.textAlign = 'right';
                for (let i = 0; i <= 100; i += 25) {
                    const y = startY - (i / 100) * chartHeight;
                    ctx.fillText(i + '%', startX - 5, y + 3);
                }
            }

            // Score Distribution Pie Chart
            const scoreCanvas = document.getElementById('scoreDistributionChart');
            if (scoreCanvas) {
                const ctx = scoreCanvas.getContext('2d');
                const width = scoreCanvas.width = scoreCanvas.offsetWidth * 2;
                const height = scoreCanvas.height = scoreCanvas.offsetHeight * 2;
                ctx.scale(2, 2);
                
                const correct = correctAnswers;
                const incorrect = questions.length - correctAnswers;
                const total = questions.length;
                
                const centerX = width / 4;
                const centerY = height / 4 - 20;
                const radius = Math.min(width, height) / 5;
                
                const correctAngle = (correct / total) * 2 * Math.PI;
                
                // Draw correct slice
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, -Math.PI / 2, -Math.PI / 2 + correctAngle);
                ctx.closePath();
                ctx.fillStyle = '#4CAF50';
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 3;
                ctx.stroke();
                
                // Draw incorrect slice
                ctx.beginPath();
                ctx.moveTo(centerX, centerY);
                ctx.arc(centerX, centerY, radius, -Math.PI / 2 + correctAngle, -Math.PI / 2 + 2 * Math.PI);
                ctx.closePath();
                ctx.fillStyle = '#F44336';
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 3;
                ctx.stroke();
                
                // Legend
                const legendY = height / 2 - 40;
                
                // Correct legend
                ctx.fillStyle = '#4CAF50';
                ctx.fillRect(20, legendY, 20, 20);
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 1;
                ctx.strokeRect(20, legendY, 20, 20);
                ctx.fillStyle = '#333';
                ctx.font = 'bold 14px Arial';
                ctx.textAlign = 'left';
                ctx.fillText(`Correct: ${correct} (${Math.round((correct/total)*100)}%)`, 45, legendY + 15);
                
                // Incorrect legend
                ctx.fillStyle = '#F44336';
                ctx.fillRect(20, legendY + 30, 20, 20);
                ctx.strokeStyle = '#333';
                ctx.lineWidth = 1;
                ctx.strokeRect(20, legendY + 30, 20, 20);
                ctx.fillStyle = '#333';
                ctx.fillText(`Incorrect: ${incorrect} (${Math.round((incorrect/total)*100)}%)`, 45, legendY + 45);
            }

            // Populate Category Performance Table
            const tableBody = document.getElementById('categoryTableBody');
            if (tableBody) {
                tableBody.innerHTML = '';
                Object.keys(categoryStats).sort().forEach(category => {
                    const stats = categoryStats[category];
                    const percentage = ((stats.correct / stats.total) * 100).toFixed(1);
                    const scoreClass = 
                        percentage >= 90 ? 'score-excellent' :
                        percentage >= 80 ? 'score-good' :
                        percentage >= 70 ? 'score-fair' : 'score-poor';
                    
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td><span class="category-badge">${category}</span></td>
                        <td>${stats.correct}</td>
                        <td>${stats.total}</td>
                        <td><span class="score-badge ${scoreClass}">${percentage}%</span></td>
                    `;
                    tableBody.appendChild(row);
                });
            }
        }
    </script>
</body>
</html>
